{"version":3,"file":"vue-upload-component.min.js","sources":["vue-upload-component.js"],"sourcesContent":["/*!\n Name: vue-upload-component \nComponent URI: https://github.com/lian-yue/vue-upload-component#readme \nVersion: 3.1.16 \nAuthor: LianYue \nLicense: Apache-2.0 \nDescription: Vue.js file upload component, Multi-file upload, Upload directory, Drag upload, Drag the directory, Upload multiple files at the same time, html4 (IE 9), `PUT` method, Customize the filter \n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('vue')) :\n  typeof define === 'function' && define.amd ? define(['vue'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.VueUploadComponent = factory(global.Vue));\n})(this, (function (vue) { 'use strict';\n\n  function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\n  function _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\n  function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? _ownKeys(Object(source), !0).forEach(function (key) { _defineProperty2(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : _ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n  function _defineProperty2(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n\n    return target;\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n  /**\n   * Creates a XHR request\n   *\n   * @param {Object} options\n   */\n\n\n  var createRequest = function createRequest(options) {\n    var xhr = new XMLHttpRequest();\n    xhr.open(options.method || 'GET', options.url);\n    xhr.responseType = 'json';\n\n    if (options.headers) {\n      Object.keys(options.headers).forEach(function (key) {\n        xhr.setRequestHeader(key, options.headers[key]);\n      });\n    }\n\n    return xhr;\n  };\n  /**\n   * Sends a XHR request with certain body\n   *\n   * @param {XMLHttpRequest} xhr\n   * @param {Object} body\n   */\n\n\n  var sendRequest = function sendRequest(xhr, body) {\n    return new Promise(function (resolve, reject) {\n      xhr.onload = function () {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.response);\n          } catch (err) {\n            response = xhr.response;\n          }\n\n          resolve(response);\n        } else {\n          reject(xhr.response);\n        }\n      };\n\n      xhr.onerror = function () {\n        return reject(xhr.response);\n      };\n\n      xhr.send(JSON.stringify(body));\n    });\n  };\n  /**\n   * Sends a XHR request with certain form data\n   *\n   * @param {XMLHttpRequest} xhr\n   * @param {Object} data\n   */\n\n\n  var sendFormRequest = function sendFormRequest(xhr, data) {\n    var body = new FormData();\n\n    for (var name in data) {\n      body.append(name, data[name]);\n    }\n\n    return new Promise(function (resolve, reject) {\n      xhr.onload = function () {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.response);\n          } catch (err) {\n            response = xhr.response;\n          }\n\n          resolve(response);\n        } else {\n          reject(xhr.response);\n        }\n      };\n\n      xhr.onerror = function () {\n        return reject(xhr.response);\n      };\n\n      xhr.send(body);\n    });\n  };\n  /**\n   * Creates and sends XHR request\n   *\n   * @param {Object} options\n   *\n   * @returns Promise\n   */\n\n\n  function request(options) {\n    var xhr = createRequest(options);\n    return sendRequest(xhr, options.body);\n  }\n\n  var ChunkUploadHandler = /*#__PURE__*/function () {\n    /**\n     * Constructor\n     *\n     * @param {File} file\n     * @param {Object} options\n     */\n    function ChunkUploadHandler(file, options) {\n      _classCallCheck(this, ChunkUploadHandler);\n\n      this.file = file;\n      this.options = options;\n      this.chunks = [];\n      this.sessionId = null;\n      this.chunkSize = null;\n      this.speedInterval = null;\n    }\n    /**\n     * Gets the max retries from options\n     */\n\n\n    _createClass(ChunkUploadHandler, [{\n      key: \"maxRetries\",\n      get: function get() {\n        return parseInt(this.options.maxRetries, 10);\n      }\n      /**\n       * Gets the max number of active chunks being uploaded at once from options\n       */\n\n    }, {\n      key: \"maxActiveChunks\",\n      get: function get() {\n        return parseInt(this.options.maxActive, 10);\n      }\n      /**\n       * Gets the file type\n       */\n\n    }, {\n      key: \"fileType\",\n      get: function get() {\n        return this.file.type;\n      }\n      /**\n       * Gets the file size\n       */\n\n    }, {\n      key: \"fileSize\",\n      get: function get() {\n        return this.file.size;\n      }\n      /**\n       * Gets the file name\n       */\n\n    }, {\n      key: \"fileName\",\n      get: function get() {\n        return this.file.name;\n      }\n      /**\n       * Gets action (url) to upload the file\n       */\n\n    }, {\n      key: \"action\",\n      get: function get() {\n        return this.options.action || null;\n      }\n      /**\n       * Gets the body to be merged when sending the request in start phase\n       */\n\n    }, {\n      key: \"startBody\",\n      get: function get() {\n        return this.options.startBody || {};\n      }\n      /**\n       * Gets the body to be merged when sending the request in upload phase\n       */\n\n    }, {\n      key: \"uploadBody\",\n      get: function get() {\n        return this.options.uploadBody || {};\n      }\n      /**\n       * Gets the body to be merged when sending the request in finish phase\n       */\n\n    }, {\n      key: \"finishBody\",\n      get: function get() {\n        return this.options.finishBody || {};\n      }\n      /**\n       * Gets the headers of the requests from options\n       */\n\n    }, {\n      key: \"headers\",\n      get: function get() {\n        return this.options.headers || {};\n      }\n      /**\n       * Whether it's ready to upload files or not\n       */\n\n    }, {\n      key: \"readyToUpload\",\n      get: function get() {\n        return !!this.chunks;\n      }\n      /**\n       * Gets the progress of the chunk upload\n       * - Gets all the completed chunks\n       * - Gets the progress of all the chunks that are being uploaded\n       */\n\n    }, {\n      key: \"progress\",\n      get: function get() {\n        var _this = this;\n\n        var completedProgress = this.chunksUploaded.length / this.chunks.length * 100;\n        var uploadingProgress = this.chunksUploading.reduce(function (progress, chunk) {\n          return progress + (chunk.progress | 0) / _this.chunks.length;\n        }, 0);\n        return Math.min(completedProgress + uploadingProgress, 100);\n      }\n      /**\n       * Gets all the chunks that are pending to be uploaded\n       */\n\n    }, {\n      key: \"chunksToUpload\",\n      get: function get() {\n        return this.chunks.filter(function (chunk) {\n          return !chunk.active && !chunk.uploaded;\n        });\n      }\n      /**\n       * Whether there are chunks to upload or not\n       */\n\n    }, {\n      key: \"hasChunksToUpload\",\n      get: function get() {\n        return this.chunksToUpload.length > 0;\n      }\n      /**\n       * Gets all the chunks that are uploading\n       */\n\n    }, {\n      key: \"chunksUploading\",\n      get: function get() {\n        return this.chunks.filter(function (chunk) {\n          return !!chunk.xhr && !!chunk.active;\n        });\n      }\n      /**\n       * Gets all the chunks that have finished uploading\n       */\n\n    }, {\n      key: \"chunksUploaded\",\n      get: function get() {\n        return this.chunks.filter(function (chunk) {\n          return !!chunk.uploaded;\n        });\n      }\n      /**\n       * Creates all the chunks in the initial state\n       */\n\n    }, {\n      key: \"createChunks\",\n      value: function createChunks() {\n        this.chunks = [];\n        var start = 0;\n        var end = this.chunkSize;\n\n        while (start < this.fileSize) {\n          this.chunks.push({\n            blob: this.file.file.slice(start, end),\n            startOffset: start,\n            active: false,\n            retries: this.maxRetries\n          });\n          start = end;\n          end = start + this.chunkSize;\n        }\n      }\n      /**\n       * Updates the progress of the file with the handler's progress\n       */\n\n    }, {\n      key: \"updateFileProgress\",\n      value: function updateFileProgress() {\n        this.file.progress = this.progress;\n      }\n      /**\n       * Paues the upload process\n       * - Stops all active requests\n       * - Sets the file not active\n       */\n\n    }, {\n      key: \"pause\",\n      value: function pause() {\n        this.file.active = false;\n        this.stopChunks();\n      }\n      /**\n       * Stops all the current chunks\n       */\n\n    }, {\n      key: \"stopChunks\",\n      value: function stopChunks() {\n        this.chunksUploading.forEach(function (chunk) {\n          chunk.xhr.abort();\n          chunk.active = false;\n        });\n        this.stopSpeedCalc();\n      }\n      /**\n       * Resumes the file upload\n       * - Sets the file active\n       * - Starts the following chunks\n       */\n\n    }, {\n      key: \"resume\",\n      value: function resume() {\n        this.file.active = true;\n        this.startChunking();\n      }\n      /**\n       * Starts the file upload\n       *\n       * @returns Promise\n       * - resolve  The file was uploaded\n       * - reject   The file upload failed\n       */\n\n    }, {\n      key: \"upload\",\n      value: function upload() {\n        var _this2 = this;\n\n        this.promise = new Promise(function (resolve, reject) {\n          _this2.resolve = resolve;\n          _this2.reject = reject;\n        });\n        this.start();\n        return this.promise;\n      }\n      /**\n       * Start phase\n       * Sends a request to the backend to initialise the chunks\n       */\n\n    }, {\n      key: \"start\",\n      value: function start() {\n        var _this3 = this;\n\n        request({\n          method: 'POST',\n          headers: _objectSpread2(_objectSpread2({}, this.headers), {}, {\n            'Content-Type': 'application/json'\n          }),\n          url: this.action,\n          body: Object.assign(this.startBody, {\n            phase: 'start',\n            mime_type: this.fileType,\n            size: this.fileSize,\n            name: this.fileName\n          })\n        }).then(function (res) {\n          if (res.status !== 'success') {\n            _this3.file.response = res;\n            return _this3.reject('server');\n          }\n\n          _this3.sessionId = res.data.session_id;\n          _this3.chunkSize = res.data.end_offset;\n\n          _this3.createChunks();\n\n          _this3.startChunking();\n        }).catch(function (res) {\n          _this3.file.response = res;\n\n          _this3.reject('server');\n        });\n      }\n      /**\n       * Starts to upload chunks\n       */\n\n    }, {\n      key: \"startChunking\",\n      value: function startChunking() {\n        for (var i = 0; i < this.maxActiveChunks; i++) {\n          this.uploadNextChunk();\n        }\n\n        this.startSpeedCalc();\n      }\n      /**\n       * Uploads the next chunk\n       * - Won't do anything if the process is paused\n       * - Will start finish phase if there are no more chunks to upload\n       */\n\n    }, {\n      key: \"uploadNextChunk\",\n      value: function uploadNextChunk() {\n        if (this.file.active) {\n          if (this.hasChunksToUpload) {\n            return this.uploadChunk(this.chunksToUpload[0]);\n          }\n\n          if (this.chunksUploading.length === 0) {\n            return this.finish();\n          }\n        }\n      }\n      /**\n       * Uploads a chunk\n       * - Sends the chunk to the backend\n       * - Sets the chunk as uploaded if everything went well\n       * - Decreases the number of retries if anything went wrong\n       * - Fails if there are no more retries\n       *\n       * @param {Object} chunk\n       */\n\n    }, {\n      key: \"uploadChunk\",\n      value: function uploadChunk(chunk) {\n        var _this4 = this;\n\n        chunk.progress = 0;\n        chunk.active = true;\n        this.updateFileProgress();\n        chunk.xhr = createRequest({\n          method: 'POST',\n          headers: this.headers,\n          url: this.action\n        });\n        chunk.xhr.upload.addEventListener('progress', function (evt) {\n          if (evt.lengthComputable) {\n            chunk.progress = Math.round(evt.loaded / evt.total * 100);\n          }\n        }, false);\n        sendFormRequest(chunk.xhr, Object.assign(this.uploadBody, {\n          phase: 'upload',\n          session_id: this.sessionId,\n          start_offset: chunk.startOffset,\n          chunk: chunk.blob\n        })).then(function (res) {\n          chunk.active = false;\n\n          if (res.status === 'success') {\n            chunk.uploaded = true;\n          } else {\n            if (chunk.retries-- <= 0) {\n              _this4.stopChunks();\n\n              return _this4.reject('upload');\n            }\n          }\n\n          _this4.uploadNextChunk();\n        }).catch(function () {\n          chunk.active = false;\n\n          if (chunk.retries-- <= 0) {\n            _this4.stopChunks();\n\n            return _this4.reject('upload');\n          }\n\n          _this4.uploadNextChunk();\n        });\n      }\n      /**\n       * Finish phase\n       * Sends a request to the backend to finish the process\n       */\n\n    }, {\n      key: \"finish\",\n      value: function finish() {\n        var _this5 = this;\n\n        this.updateFileProgress();\n        this.stopSpeedCalc();\n        request({\n          method: 'POST',\n          headers: _objectSpread2(_objectSpread2({}, this.headers), {}, {\n            'Content-Type': 'application/json'\n          }),\n          url: this.action,\n          body: Object.assign(this.finishBody, {\n            phase: 'finish',\n            session_id: this.sessionId\n          })\n        }).then(function (res) {\n          _this5.file.response = res;\n\n          if (res.status !== 'success') {\n            return _this5.reject('server');\n          }\n\n          _this5.resolve(res);\n        }).catch(function (res) {\n          _this5.file.response = res;\n\n          _this5.reject('server');\n        });\n      }\n      /**\n       * Sets an interval to calculate and\n       * set upload speed every 3 seconds\n       */\n\n    }, {\n      key: \"startSpeedCalc\",\n      value: function startSpeedCalc() {\n        var _this6 = this;\n\n        this.file.speed = 0;\n        var lastUploadedBytes = 0;\n\n        if (!this.speedInterval) {\n          this.speedInterval = window.setInterval(function () {\n            var uploadedBytes = _this6.progress / 100 * _this6.fileSize;\n            _this6.file.speed = uploadedBytes - lastUploadedBytes;\n            lastUploadedBytes = uploadedBytes;\n          }, 1000);\n        }\n      }\n      /**\n       * Removes the upload speed interval\n       */\n\n    }, {\n      key: \"stopSpeedCalc\",\n      value: function stopSpeedCalc() {\n        this.speedInterval && window.clearInterval(this.speedInterval);\n        this.speedInterval = null;\n        this.file.speed = 0;\n      }\n    }]);\n\n    return ChunkUploadHandler;\n  }();\n\n  var CHUNK_DEFAULT_OPTIONS = {\n    headers: {},\n    action: '',\n    minSize: 1048576,\n    maxActive: 3,\n    maxRetries: 5,\n    handler: ChunkUploadHandler\n  };\n  var script = vue.defineComponent({\n    compatConfig: {\n      MODE: 3\n    },\n    props: {\n      inputId: {\n        type: String\n      },\n      name: {\n        type: String,\n        default: 'file'\n      },\n      accept: {\n        type: String\n      },\n      capture: {},\n      disabled: {\n        default: false\n      },\n      multiple: {\n        type: Boolean,\n        default: false\n      },\n      maximum: {\n        type: Number\n      },\n      addIndex: {\n        type: [Boolean, Number]\n      },\n      directory: {\n        type: Boolean\n      },\n      createDirectory: {\n        type: Boolean,\n        default: false\n      },\n      postAction: {\n        type: String\n      },\n      putAction: {\n        type: String\n      },\n      customAction: {\n        type: Function\n      },\n      headers: {\n        type: Object,\n        default: function _default() {\n          return {};\n        }\n      },\n      data: {\n        type: Object,\n        default: function _default() {\n          return {};\n        }\n      },\n      timeout: {\n        type: Number,\n        default: 0\n      },\n      drop: {\n        type: [Boolean, String, HTMLElement],\n        default: function _default() {\n          return false;\n        }\n      },\n      dropDirectory: {\n        type: Boolean,\n        default: true\n      },\n      size: {\n        type: Number,\n        default: 0\n      },\n      extensions: {\n        type: [RegExp, String, Array],\n        default: function _default() {\n          return [];\n        }\n      },\n      modelValue: {\n        type: Array,\n        default: function _default() {\n          return [];\n        }\n      },\n      thread: {\n        type: Number,\n        default: 1\n      },\n      // Chunk upload enabled\n      chunkEnabled: {\n        type: Boolean,\n        default: false\n      },\n      // Chunk upload properties\n      chunk: {\n        type: Object,\n        default: function _default() {\n          return CHUNK_DEFAULT_OPTIONS;\n        }\n      }\n    },\n    emits: ['update:modelValue', 'input-filter', 'input-file'],\n    data: function data() {\n      return {\n        files: this.modelValue,\n        features: {\n          html5: true,\n          directory: false,\n          drop: false\n        },\n        active: false,\n        dropActive: false,\n        dropElementActive: false,\n        uploading: 0,\n        destroy: false,\n        maps: {},\n        dropElement: null,\n        dropTimeout: null,\n        reload: false\n      };\n    },\n\n    /**\r\n     * mounted\r\n     * @return {[type]} [description]\r\n     */\n    mounted: function mounted() {\n      var _this7 = this;\n\n      var input = document.createElement('input');\n      input.type = 'file';\n      input.multiple = true; // html5 特征\n\n      if (window.FormData && input.files) {\n        // 上传目录特征\n        // @ts-ignore\n        if (typeof input.webkitdirectory === 'boolean' || typeof input.directory === 'boolean') {\n          this.features.directory = true;\n        } // 拖拽特征. 要兼容 relatedTarget\n\n\n        if (this.features.html5 && typeof input.ondrop !== 'undefined' && this.isRelatedTargetSupported()) {\n          this.features.drop = true;\n        }\n      } else {\n        this.features.html5 = false;\n      } // files 定位缓存\n\n\n      this.maps = {};\n\n      if (this.files) {\n        for (var i = 0; i < this.files.length; i++) {\n          var file = this.files[i];\n          this.maps[file.id] = file;\n        }\n      } // @ts-ignore\n\n\n      this.$nextTick(function () {\n        // 更新下父级\n        if (_this7.$parent) {\n          _this7.$parent.$forceUpdate(); // 拖拽渲染\n\n\n          _this7.$parent.$nextTick(function () {\n            _this7.watchDrop(_this7.drop);\n          });\n        } else {\n          // 拖拽渲染\n          _this7.watchDrop(_this7.drop);\n        }\n      });\n    },\n\n    /**\r\n     * beforeUnmount\r\n     * @return {[type]} [description]\r\n     */\n    beforeUnmount: function beforeUnmount() {\n      // 已销毁\n      this.destroy = true; // 设置成不激活\n\n      this.active = false; // 销毁拖拽事件\n\n      this.watchDrop(false); // 销毁不激活\n\n      this.watchActive(false);\n    },\n    computed: {\n      /**\r\n       * uploading 正在上传的线程\r\n       * @return {[type]} [description]\r\n       */\n\n      /**\r\n       * uploaded 文件列表是否全部已上传\r\n       * @return {[type]} [description]\r\n       */\n      uploaded: function uploaded() {\n        var file;\n\n        for (var i = 0; i < this.files.length; i++) {\n          file = this.files[i];\n\n          if (file.fileObject && !file.error && !file.success) {\n            return false;\n          }\n        }\n\n        return true;\n      },\n      chunkOptions: function chunkOptions() {\n        return Object.assign(CHUNK_DEFAULT_OPTIONS, this.chunk);\n      },\n      className: function className() {\n        return ['file-uploads', this.features.html5 ? 'file-uploads-html5' : 'file-uploads-html4', this.features.directory && this.directory ? 'file-uploads-directory' : undefined, this.features.drop && this.drop ? 'file-uploads-drop' : undefined, this.disabled ? 'file-uploads-disabled' : undefined];\n      },\n      forId: function forId() {\n        return this.inputId || this.name;\n      },\n      iMaximum: function iMaximum() {\n        if (this.maximum === undefined) {\n          return this.multiple ? 0 : 1;\n        }\n\n        return this.maximum;\n      },\n      iExtensions: function iExtensions() {\n        if (!this.extensions) {\n          return;\n        }\n\n        if (this.extensions instanceof RegExp) {\n          return this.extensions;\n        }\n\n        if (!this.extensions.length) {\n          return;\n        }\n\n        var exts = [];\n\n        if (typeof this.extensions === 'string') {\n          exts = this.extensions.split(',');\n        } else {\n          exts = this.extensions;\n        }\n\n        exts = exts.map(function (value) {\n          return value.trim();\n        }).filter(function (value) {\n          return value;\n        });\n        return new RegExp('\\\\.(' + exts.join('|').replace(/\\./g, '\\\\.') + ')$', 'i');\n      },\n      iDirectory: function iDirectory() {\n        if (this.directory && this.features.directory) {\n          return true;\n        }\n\n        return undefined;\n      }\n    },\n    watch: {\n      active: function active(_active) {\n        this.watchActive(_active);\n      },\n      dropActive: function dropActive(value) {\n        this.watchDropActive(value);\n\n        if (this.$parent) {\n          this.$parent.$forceUpdate();\n        }\n      },\n      drop: function drop(value) {\n        this.watchDrop(value);\n      },\n      modelValue: function modelValue(files) {\n        if (this.files === files) {\n          return;\n        }\n\n        this.files = files;\n        var oldMaps = this.maps; // 重写 maps 缓存\n\n        this.maps = {};\n\n        for (var i = 0; i < this.files.length; i++) {\n          var file = this.files[i];\n          this.maps[file.id] = file;\n        } // add, update\n\n\n        for (var key in this.maps) {\n          var newFile = this.maps[key];\n          var oldFile = oldMaps[key];\n\n          if (newFile !== oldFile) {\n            this.emitFile(newFile, oldFile);\n          }\n        } // delete\n\n\n        for (var _key in oldMaps) {\n          if (!this.maps[_key]) {\n            this.emitFile(undefined, oldMaps[_key]);\n          }\n        }\n      }\n    },\n    methods: {\n      newId: function newId() {\n        return Math.random().toString(36).substr(2);\n      },\n      // 清空\n      clear: function clear() {\n        if (this.files.length) {\n          var files = this.files;\n          this.files = []; // 定位\n\n          this.maps = {}; // 事件\n\n          this.emitInput();\n\n          for (var i = 0; i < files.length; i++) {\n            this.emitFile(undefined, files[i]);\n          }\n        }\n\n        return true;\n      },\n      // 选择\n      get: function get(id) {\n        if (!id) {\n          return false;\n        }\n\n        if (_typeof(id) === 'object') {\n          return this.maps[id.id || ''] || false;\n        }\n\n        return this.maps[id] || false;\n      },\n      // 添加\n      add: function add(_files, index) {\n        // 不是数组整理成数组\n        var files;\n\n        if (_files instanceof Array) {\n          files = _files;\n        } else {\n          files = [_files];\n        }\n\n        if (index === undefined) {\n          // eslint-disable-next-line\n          index = this.addIndex;\n        } // 遍历规范对象\n\n\n        var addFiles = [];\n\n        for (var i = 0; i < files.length; i++) {\n          var file = files[i];\n\n          if (this.features.html5 && file instanceof Blob) {\n            file = {\n              id: '',\n              file: file,\n              size: file.size,\n              // @ts-ignore\n              name: file.webkitRelativePath || file.relativePath || file.name || 'unknown',\n              type: file.type\n            };\n          }\n\n          file = file;\n          var fileObject = false;\n          if (file.fileObject === false) ;else if (file.fileObject) {\n            fileObject = true;\n          } else if (typeof Element !== 'undefined' && file.el instanceof HTMLInputElement) {\n            fileObject = true;\n          } else if (typeof Blob !== 'undefined' && file.file instanceof Blob) {\n            fileObject = true;\n          }\n\n          if (fileObject) {\n            file = _objectSpread(_objectSpread({\n              fileObject: true,\n              size: -1,\n              name: 'Filename',\n              type: '',\n              active: false,\n              error: '',\n              success: false,\n              putAction: this.putAction,\n              postAction: this.postAction,\n              timeout: this.timeout\n            }, file), {}, {\n              response: {},\n              progress: '0.00',\n              speed: 0 // 只读\n              // file: undefined,\n              // xhr: undefined,\n              // el: undefined,\n              // iframe: undefined,\n\n            });\n            file.data = _objectSpread(_objectSpread({}, this.data), file.data ? file.data : {});\n            file.headers = _objectSpread(_objectSpread({}, this.headers), file.headers ? file.headers : {});\n          } // 必须包含 id\n\n\n          if (!file.id) {\n            file.id = this.newId();\n          }\n\n          if (this.emitFilter(file, undefined)) {\n            continue;\n          } // 最大数量限制\n\n\n          if (this.iMaximum > 1 && addFiles.length + this.files.length >= this.iMaximum) {\n            break;\n          }\n\n          addFiles.push(file); // 最大数量限制\n\n          if (this.iMaximum === 1) {\n            break;\n          }\n        } // 没有文件\n\n\n        if (!addFiles.length) {\n          return;\n        } // 如果是 1 清空\n\n\n        if (this.iMaximum === 1) {\n          this.clear();\n        } // 添加进去 files\n\n\n        var newFiles;\n\n        if (index === true || index === 0) {\n          newFiles = addFiles.concat(this.files);\n        } else if (index) {\n          var _newFiles;\n\n          newFiles = this.files.concat([]);\n\n          (_newFiles = newFiles).splice.apply(_newFiles, [index, 0].concat(_toConsumableArray(addFiles)));\n        } else {\n          newFiles = this.files.concat(addFiles);\n        }\n\n        this.files = newFiles; // 读取代理后的数据\n\n        var index2 = 0;\n\n        if (index === true || index === 0) {\n          index2 = 0;\n        } else if (index) {\n          if (index >= 0) {\n            if (index + addFiles.length > this.files.length) {\n              index2 = this.files.length - addFiles.length;\n            } else {\n              index2 = index;\n            }\n          } else {\n            index2 = this.files.length - addFiles.length + index;\n\n            if (index2 < 0) {\n              index2 = 0;\n            }\n          }\n        } else {\n          index2 = this.files.length - addFiles.length;\n        }\n\n        addFiles = this.files.slice(index2, index2 + addFiles.length); // 定位\n\n        for (var _i = 0; _i < addFiles.length; _i++) {\n          var _file = addFiles[_i];\n          this.maps[_file.id] = _file;\n        } // 事件\n\n\n        this.emitInput();\n\n        for (var _i2 = 0; _i2 < addFiles.length; _i2++) {\n          this.emitFile(addFiles[_i2], undefined);\n        }\n\n        return _files instanceof Array ? addFiles : addFiles[0];\n      },\n      // 添加表单文件\n      addInputFile: function addInputFile(el) {\n        var _this8 = this;\n\n        var files = [];\n        this.iMaximum; // @ts-ignore\n\n        var entrys = el.webkitEntries || el.entries || undefined;\n\n        if (entrys !== null && entrys !== void 0 && entrys.length) {\n          return this.getFileSystemEntry(entrys).then(function (files) {\n            return _this8.add(files);\n          });\n        }\n\n        if (el.files) {\n          for (var i = 0; i < el.files.length; i++) {\n            var file = el.files[i];\n            files.push({\n              id: '',\n              size: file.size,\n              // @ts-ignore\n              name: file.webkitRelativePath || file.relativePath || file.name,\n              type: file.type,\n              file: file\n            });\n          }\n        } else {\n          var names = el.value.replace(/\\\\/g, '/').split('/');\n\n          if (!names || !names.length) {\n            names = [el.value];\n          } // @ts-ignore\n\n\n          delete el.__vuex__;\n          files.push({\n            id: '',\n            name: names[names.length - 1],\n            el: el\n          });\n        }\n\n        return Promise.resolve(this.add(files));\n      },\n      // 添加 DataTransfer\n      addDataTransfer: function addDataTransfer(dataTransfer) {\n        var _dataTransfer$items,\n            _this9 = this;\n\n        // dataTransfer.items 支持\n        if (dataTransfer !== null && dataTransfer !== void 0 && (_dataTransfer$items = dataTransfer.items) !== null && _dataTransfer$items !== void 0 && _dataTransfer$items.length) {\n          var entrys = []; // 遍历出所有 dataTransferVueUploadItem\n\n          for (var i = 0; i < dataTransfer.items.length; i++) {\n            var dataTransferTtem = dataTransfer.items[i];\n            var entry = void 0; // @ts-ignore\n\n            if (dataTransferTtem.getAsEntry) {\n              // @ts-ignore\n              entry = dataTransferTtem.getAsEntry() || dataTransferTtem.getAsFile();\n            } else if (dataTransferTtem.webkitGetAsEntry) {\n              entry = dataTransferTtem.webkitGetAsEntry() || dataTransferTtem.getAsFile();\n            } else {\n              entry = dataTransferTtem.getAsFile();\n            }\n\n            if (entry) {\n              entrys.push(entry);\n            }\n          }\n\n          return this.getFileSystemEntry(entrys).then(function (files) {\n            return _this9.add(files);\n          });\n        } // dataTransfer.files 支持\n\n\n        var maximumValue = this.iMaximum;\n        var files = [];\n\n        if (dataTransfer.files.length) {\n          for (var _i3 = 0; _i3 < dataTransfer.files.length; _i3++) {\n            files.push(dataTransfer.files[_i3]);\n\n            if (maximumValue > 0 && files.length >= maximumValue) {\n              break;\n            }\n          }\n\n          return Promise.resolve(this.add(files));\n        }\n\n        return Promise.resolve([]);\n      },\n      // 获得 entrys    \n      getFileSystemEntry: function getFileSystemEntry(entry) {\n        var _this10 = this;\n\n        var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n        // getFileSystemEntry(entry: any, path = ''): Promise<VueUploadItem[]> {\n        return new Promise(function (resolve) {\n          var maximumValue = _this10.iMaximum;\n\n          if (!entry) {\n            resolve([]);\n            return;\n          }\n\n          if (entry instanceof Array) {\n            // 多个\n            var uploadFiles = [];\n\n            var forEach = function forEach(i) {\n              var v = entry[i];\n\n              if (!v || maximumValue > 0 && uploadFiles.length >= maximumValue) {\n                return resolve(uploadFiles);\n              }\n\n              _this10.getFileSystemEntry(v, path).then(function (results) {\n                uploadFiles.push.apply(uploadFiles, _toConsumableArray(results));\n                forEach(i + 1);\n              });\n            };\n\n            forEach(0);\n            return;\n          }\n\n          if (entry instanceof Blob) {\n            resolve([{\n              id: '',\n              size: entry.size,\n              // @ts-ignore\n              name: path + entry.name,\n              type: entry.type,\n              file: entry\n            }]);\n            return;\n          }\n\n          if (entry.isFile) {\n            var fileEntry = entry;\n            fileEntry.file(function (file) {\n              resolve([{\n                id: '',\n                size: file.size,\n                name: path + file.name,\n                type: file.type,\n                file: file\n              }]);\n            });\n            return;\n          }\n\n          if (entry.isDirectory && _this10.dropDirectory) {\n            var directoryEntry = entry;\n            var _uploadFiles = []; // 目录也要添加到文件列表\n\n            if (_this10.createDirectory) {\n              _uploadFiles.push({\n                id: '',\n                name: path + directoryEntry.name,\n                size: 0,\n                type: 'text/directory',\n                file: new File([], path + directoryEntry.name, {\n                  type: 'text/directory'\n                })\n              });\n            }\n\n            var dirReader = directoryEntry.createReader();\n\n            var readEntries = function readEntries() {\n              dirReader.readEntries(function (entries) {\n                var forEach = function forEach(i) {\n                  if (!entries[i] && i === 0 || maximumValue > 0 && _uploadFiles.length >= maximumValue) {\n                    return resolve(_uploadFiles);\n                  }\n\n                  if (!entries[i]) {\n                    return readEntries();\n                  }\n\n                  _this10.getFileSystemEntry(entries[i], path + directoryEntry.name + '/').then(function (results) {\n                    _uploadFiles.push.apply(_uploadFiles, _toConsumableArray(results));\n\n                    forEach(i + 1);\n                  });\n                };\n\n                forEach(0);\n              });\n            };\n\n            readEntries();\n            return;\n          }\n\n          resolve([]);\n        });\n      },\n      // 替换\n      replace: function replace(id1, id2) {\n        var file1 = this.get(id1);\n        var file2 = this.get(id2);\n\n        if (!file1 || !file2 || file1 === file2) {\n          return false;\n        }\n\n        var files = this.files.concat([]);\n        var index1 = files.indexOf(file1);\n        var index2 = files.indexOf(file2);\n\n        if (index1 === -1 || index2 === -1) {\n          return false;\n        }\n\n        files[index1] = file2;\n        files[index2] = file1;\n        this.files = files;\n        this.emitInput();\n        return true;\n      },\n      // 移除\n      remove: function remove(id) {\n        var file = this.get(id);\n\n        if (file) {\n          if (this.emitFilter(undefined, file)) {\n            return false;\n          }\n\n          var files = this.files.concat([]);\n          var index = files.indexOf(file);\n\n          if (index === -1) {\n            console.error('remove', file);\n            return false;\n          }\n\n          files.splice(index, 1);\n          this.files = files; // 定位\n\n          delete this.maps[file.id]; // 事件\n\n          this.emitInput();\n          this.emitFile(undefined, file);\n        }\n\n        return file;\n      },\n      // 更新\n      update: function update(id, data) {\n        var file = this.get(id);\n\n        if (file) {\n          var newFile = _objectSpread(_objectSpread({}, file), data); // 停用必须加上错误\n\n\n          if (file.fileObject && file.active && !newFile.active && !newFile.error && !newFile.success) {\n            newFile.error = 'abort';\n          }\n\n          if (this.emitFilter(newFile, file)) {\n            return false;\n          }\n\n          var files = this.files.concat([]);\n          var index = files.indexOf(file);\n\n          if (index === -1) {\n            console.error('update', file);\n            return false;\n          }\n\n          files.splice(index, 1, newFile);\n          this.files = files;\n          newFile = this.files[index]; // 删除  旧定位 写入 新定位 （已便支持修改id)\n\n          delete this.maps[file.id];\n          this.maps[newFile.id] = newFile; // 事件\n\n          this.emitInput();\n          this.emitFile(newFile, file);\n          return newFile;\n        }\n\n        return false;\n      },\n      // 预处理 事件 过滤器\n      emitFilter: function emitFilter(newFile, oldFile) {\n        var isPrevent = false;\n        this.$emit('input-filter', newFile, oldFile, function () {\n          var prevent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n          isPrevent = prevent;\n          return isPrevent;\n        });\n        return isPrevent;\n      },\n      // 处理后 事件 分发\n      emitFile: function emitFile(newFile, oldFile) {\n        var _newFile,\n            _this11 = this;\n\n        this.$emit('input-file', newFile, oldFile);\n\n        if ((_newFile = newFile) !== null && _newFile !== void 0 && _newFile.fileObject && newFile.active && (!oldFile || !oldFile.active)) {\n          this.uploading++; // 激活\n          // @ts-ignore\n\n          this.$nextTick(function () {\n            setTimeout(function () {\n              newFile && _this11.upload(newFile).then(function () {\n                var _newFile2;\n\n                if (newFile) {\n                  // eslint-disable-next-line\n                  newFile = _this11.get(newFile) || undefined;\n                }\n\n                if ((_newFile2 = newFile) !== null && _newFile2 !== void 0 && _newFile2.fileObject) {\n                  _this11.update(newFile, {\n                    active: false,\n                    success: !newFile.error\n                  });\n                }\n              }).catch(function (e) {\n                newFile && _this11.update(newFile, {\n                  active: false,\n                  success: false,\n                  error: e.code || e.error || e.message || e\n                });\n              });\n            }, Math.ceil(Math.random() * 50 + 50));\n          });\n        } else if ((!newFile || !newFile.fileObject || !newFile.active) && oldFile && oldFile.fileObject && oldFile.active) {\n          // 停止\n          this.uploading--;\n        } // 自动延续激活\n        // @ts-ignore\n\n\n        if (this.active && (Boolean(newFile) !== Boolean(oldFile) || newFile.active !== oldFile.active)) {\n          this.watchActive(true);\n        }\n      },\n      emitInput: function emitInput() {\n        this.$emit('update:modelValue', this.files);\n      },\n      // 上传\n      upload: function upload(id) {\n        var file = this.get(id); // 被删除\n\n        if (!file) {\n          return Promise.reject(new Error('not_exists'));\n        } // 不是文件对象\n\n\n        if (!file.fileObject) {\n          return Promise.reject(new Error('file_object'));\n        } // 有错误直接响应\n\n\n        if (file.error) {\n          if (file.error instanceof Error) {\n            return Promise.reject(file.error);\n          }\n\n          return Promise.reject(new Error(file.error));\n        } // 已完成直接响应\n\n\n        if (file.success) {\n          return Promise.resolve(file);\n        } // 后缀\n\n\n        if (file.name && this.iExtensions && file.type !== \"text/directory\") {\n          if (file.name.search(this.iExtensions) === -1) {\n            return Promise.reject(new Error('extension'));\n          }\n        } // 大小\n\n\n        if (this.size > 0 && file.size !== undefined && file.size >= 0 && file.size > this.size && file.type !== \"text/directory\") {\n          return Promise.reject(new Error('size'));\n        }\n\n        if (this.customAction) {\n          return this.customAction(file, this);\n        }\n\n        if (this.features.html5) {\n          if (this.shouldUseChunkUpload(file)) {\n            return this.uploadChunk(file);\n          }\n\n          if (file.putAction) {\n            return this.uploadPut(file);\n          }\n\n          if (file.postAction) {\n            return this.uploadHtml5(file);\n          }\n        }\n\n        if (file.postAction) {\n          return this.uploadHtml4(file);\n        }\n\n        return Promise.reject(new Error('No action configured'));\n      },\n\n      /**\r\n       * Whether this file should be uploaded using chunk upload or not\r\n       *\r\n       * @param Object file\r\n       */\n      shouldUseChunkUpload: function shouldUseChunkUpload(file) {\n        return this.chunkEnabled && !!this.chunkOptions.handler && file.size && file.size > this.chunkOptions.minSize;\n      },\n\n      /**\r\n       * Upload a file using Chunk method\r\n       *\r\n       * @param File file\r\n       */\n      uploadChunk: function uploadChunk(file) {\n        var HandlerClass = this.chunkOptions.handler;\n        file.chunk = new HandlerClass(file, this.chunkOptions);\n        return file.chunk.upload().then(function (res) {\n          return file;\n        });\n      },\n      uploadPut: function uploadPut(file) {\n        var querys = [];\n        var value;\n\n        for (var key in file.data) {\n          value = file.data[key];\n\n          if (value !== null && value !== undefined) {\n            querys.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n          }\n        }\n\n        var putAction = file.putAction || '';\n        var queryString = querys.length ? (putAction.indexOf('?') === -1 ? '?' : '&') + querys.join('&') : '';\n        var xhr = new XMLHttpRequest();\n        xhr.open('PUT', putAction + queryString);\n        return this.uploadXhr(xhr, file, file.file);\n      },\n      uploadHtml5: function uploadHtml5(file) {\n        var form = new window.FormData();\n        var value;\n\n        for (var key in file.data) {\n          value = file.data[key];\n\n          if (value && _typeof(value) === 'object' && typeof value.toString !== 'function') {\n            if (value instanceof File) {\n              form.append(key, value, value.name);\n            } else {\n              form.append(key, JSON.stringify(value));\n            }\n          } else if (value !== null && value !== undefined) {\n            form.append(key, value);\n          }\n        } // Moved file.name as the first option to set the filename of the uploaded file, since file.name\n        // contains the full (relative) path of the file not just the filename as in file.file.filename\n        // @ts-ignore\n\n\n        form.append(this.name, file.file, file.name || file.file.name || file.file.filename);\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', file.postAction || '');\n        return this.uploadXhr(xhr, file, form);\n      },\n      uploadXhr: function uploadXhr(xhr, ufile, body) {\n        var _this12 = this;\n\n        var file = ufile;\n        var speedTime = 0;\n        var speedLoaded = 0; // 进度条\n\n        xhr.upload.onprogress = function (e) {\n          // 还未开始上传 已删除 未激活\n          if (!file) {\n            return;\n          }\n\n          file = _this12.get(file);\n\n          if (!e.lengthComputable || !file || !file.fileObject || !file.active) {\n            return;\n          } // 进度 速度 每秒更新一次\n\n\n          var speedTime2 = Math.round(Date.now() / 1000);\n\n          if (speedTime2 === speedTime) {\n            return;\n          }\n\n          speedTime = speedTime2;\n          file = _this12.update(file, {\n            progress: (e.loaded / e.total * 100).toFixed(2),\n            speed: e.loaded - speedLoaded\n          });\n          speedLoaded = e.loaded;\n        }; // 检查激活状态\n\n\n        var interval = window.setInterval(function () {\n          if (file) {\n            if (file = _this12.get(file)) {\n              var _file2;\n\n              if ((_file2 = file) !== null && _file2 !== void 0 && _file2.fileObject && !file.success && !file.error && file.active) {\n                return;\n              }\n            }\n          }\n\n          if (interval) {\n            clearInterval(interval);\n            interval = undefined;\n          }\n\n          try {\n            xhr.abort();\n            xhr.timeout = 1;\n          } catch (e) {}\n        }, 100);\n        return new Promise(function (resolve, reject) {\n          if (!file) {\n            reject(new Error('not_exists'));\n            return;\n          }\n\n          var complete;\n\n          var fn = function fn(e) {\n            // 已经处理过了\n            if (complete) {\n              return;\n            }\n\n            complete = true;\n\n            if (interval) {\n              clearInterval(interval);\n              interval = undefined;\n            }\n\n            if (!file) {\n              return reject(new Error('not_exists'));\n            }\n\n            file = _this12.get(file); // 不存在直接响应\n\n            if (!file) {\n              return reject(new Error('not_exists'));\n            } // 不是文件对象\n\n\n            if (!file.fileObject) {\n              return reject(new Error('file_object'));\n            } // 有错误自动响应\n\n\n            if (file.error) {\n              if (file.error instanceof Error) {\n                return reject(file.error);\n              }\n\n              return reject(new Error(file.error));\n            } // 未激活\n\n\n            if (!file.active) {\n              return reject(new Error('abort'));\n            } // 已完成 直接相应\n\n\n            if (file.success) {\n              return resolve(file);\n            }\n\n            var data = {};\n\n            switch (e.type) {\n              case 'timeout':\n              case 'abort':\n                data.error = e.type;\n                break;\n\n              case 'error':\n                if (!xhr.status) {\n                  data.error = 'network';\n                } else if (xhr.status >= 500) {\n                  data.error = 'server';\n                } else if (xhr.status >= 400) {\n                  data.error = 'denied';\n                }\n\n                break;\n\n              default:\n                if (xhr.status >= 500) {\n                  data.error = 'server';\n                } else if (xhr.status >= 400) {\n                  data.error = 'denied';\n                } else {\n                  data.progress = '100.00';\n                }\n\n            }\n\n            if (xhr.responseText) {\n              var contentType = xhr.getResponseHeader('Content-Type');\n\n              if (contentType && contentType.indexOf('/json') !== -1) {\n                data.response = JSON.parse(xhr.responseText);\n              } else {\n                data.response = xhr.responseText;\n              }\n            } // 更新\n            // @ts-ignore\n\n\n            file = _this12.update(file, data);\n\n            if (!file) {\n              return reject(new Error('abort'));\n            } // 有错误自动响应\n\n\n            if (file.error) {\n              if (file.error instanceof Error) {\n                return reject(file.error);\n              }\n\n              return reject(new Error(file.error));\n            } // 响应\n\n\n            return resolve(file);\n          }; // 事件\n\n\n          xhr.onload = fn;\n          xhr.onerror = fn;\n          xhr.onabort = fn;\n          xhr.ontimeout = fn; // 超时\n\n          if (file.timeout) {\n            xhr.timeout = file.timeout;\n          } // headers\n\n\n          for (var key in file.headers) {\n            xhr.setRequestHeader(key, file.headers[key]);\n          } // 更新 xhr\n          // @ts-ignore\n\n\n          file = _this12.update(file, {\n            xhr: xhr\n          }); // 开始上传\n\n          file && xhr.send(body);\n        });\n      },\n      uploadHtml4: function uploadHtml4(ufile) {\n        var _this13 = this;\n\n        var file = ufile;\n\n        if (!file) {\n          return Promise.reject(new Error('not_exists'));\n        }\n\n        var onKeydown = function onKeydown(e) {\n          if (e.keyCode === 27) {\n            e.preventDefault();\n          }\n        };\n\n        var iframe = document.createElement('iframe');\n        iframe.id = 'upload-iframe-' + file.id;\n        iframe.name = 'upload-iframe-' + file.id;\n        iframe.src = 'about:blank';\n        iframe.setAttribute('style', 'width:1px;height:1px;top:-999em;position:absolute; margin-top:-999em;');\n        var form = document.createElement('form');\n        form.setAttribute('action', file.postAction || '');\n        form.name = 'upload-form-' + file.id;\n        form.setAttribute('method', 'POST');\n        form.setAttribute('target', 'upload-iframe-' + file.id);\n        form.setAttribute('enctype', 'multipart/form-data');\n\n        for (var key in file.data) {\n          var value = file.data[key];\n\n          if (value && _typeof(value) === 'object' && typeof value.toString !== 'function') {\n            value = JSON.stringify(value);\n          }\n\n          if (value !== null && value !== undefined) {\n            var el = document.createElement('input');\n            el.type = 'hidden';\n            el.name = key;\n            el.value = value;\n            form.appendChild(el);\n          }\n        }\n\n        form.appendChild(file.el);\n        document.body.appendChild(iframe).appendChild(form);\n\n        var getResponseData = function getResponseData() {\n          var _doc;\n\n          var doc;\n\n          try {\n            if (iframe.contentWindow) {\n              doc = iframe.contentWindow.document;\n            }\n          } catch (err) {}\n\n          if (!doc) {\n            try {\n              // @ts-ignore\n              doc = iframe.contentDocument ? iframe.contentDocument : iframe.document;\n            } catch (err) {\n              // @ts-ignore\n              doc = iframe.document;\n            }\n          } // @ts-ignore\n\n\n          if ((_doc = doc) !== null && _doc !== void 0 && _doc.body) {\n            return doc.body.innerHTML;\n          }\n\n          return null;\n        };\n\n        return new Promise(function (resolve, reject) {\n          setTimeout(function () {\n            if (!file) {\n              reject(new Error('not_exists'));\n              return;\n            }\n\n            file = _this13.update(file, {\n              iframe: iframe\n            }); // 不存在\n\n            if (!file) {\n              return reject(new Error('not_exists'));\n            } // 定时检查\n\n\n            var interval = window.setInterval(function () {\n              if (file) {\n                if (file = _this13.get(file)) {\n                  if (file.fileObject && !file.success && !file.error && file.active) {\n                    return;\n                  }\n                }\n              }\n\n              if (interval) {\n                clearInterval(interval);\n                interval = undefined;\n              } // @ts-ignore\n\n\n              iframe.onabort({\n                type: file ? 'abort' : 'not_exists'\n              });\n            }, 100);\n            var complete;\n\n            var fn = function fn(e) {\n              var _file3;\n\n              // 已经处理过了\n              if (complete) {\n                return;\n              }\n\n              complete = true;\n\n              if (interval) {\n                clearInterval(interval);\n                interval = undefined;\n              } // 关闭 esc 事件\n\n\n              document.body.removeEventListener('keydown', onKeydown);\n\n              if (!file) {\n                return reject(new Error('not_exists'));\n              }\n\n              file = _this13.get(file); // 不存在直接响应\n\n              if (!file) {\n                return reject(new Error('not_exists'));\n              } // 不是文件对象\n\n\n              if (!file.fileObject) {\n                return reject(new Error('file_object'));\n              } // 有错误自动响应\n\n\n              if (file.error) {\n                if (file.error instanceof Error) {\n                  return reject(file.error);\n                }\n\n                return reject(new Error(file.error));\n              } // 未激活\n\n\n              if (!file.active) {\n                return reject(new Error('abort'));\n              } // 已完成 直接相应\n\n\n              if (file.success) {\n                return resolve(file);\n              }\n\n              var response = getResponseData();\n              var data = {};\n\n              if (typeof e === 'string') {\n                return reject(new Error(e));\n              }\n\n              switch (e.type) {\n                case 'abort':\n                  data.error = 'abort';\n                  break;\n\n                case 'error':\n                  if (file.error) {\n                    data.error = file.error;\n                  } else if (response === null) {\n                    data.error = 'network';\n                  } else {\n                    data.error = 'denied';\n                  }\n\n                  break;\n\n                default:\n                  if (file.error) {\n                    data.error = file.error;\n                  } else if (response === null) {\n                    data.error = 'network';\n                  } else {\n                    data.progress = '100.00';\n                  }\n\n              }\n\n              if (response !== null) {\n                if (response && response.substr(0, 1) === '{' && response.substr(response.length - 1, 1) === '}') {\n                  try {\n                    response = JSON.parse(response);\n                  } catch (err) {}\n                }\n\n                data.response = response;\n              } // 更新\n\n\n              file = _this13.update(file, data);\n\n              if (!file) {\n                return reject(new Error('not_exists'));\n              }\n\n              if ((_file3 = file) !== null && _file3 !== void 0 && _file3.error) {\n                if (file.error instanceof Error) {\n                  return reject(file.error);\n                }\n\n                return reject(new Error(file.error));\n              } // 响应\n\n\n              return resolve(file);\n            }; // 添加事件\n\n\n            iframe.onload = fn;\n            iframe.onerror = fn;\n            iframe.onabort = fn; // 禁止 esc 键\n\n            document.body.addEventListener('keydown', onKeydown); // 提交\n\n            form.submit();\n          }, 50);\n        }).then(function (res) {\n          var _iframe$parentNode;\n\n          iframe === null || iframe === void 0 ? void 0 : (_iframe$parentNode = iframe.parentNode) === null || _iframe$parentNode === void 0 ? void 0 : _iframe$parentNode.removeChild(iframe);\n          return res;\n        }).catch(function (res) {\n          var _iframe$parentNode2;\n\n          iframe === null || iframe === void 0 ? void 0 : (_iframe$parentNode2 = iframe.parentNode) === null || _iframe$parentNode2 === void 0 ? void 0 : _iframe$parentNode2.removeChild(iframe);\n          return res;\n        });\n      },\n      watchActive: function watchActive(active) {\n        var file;\n        var index = 0;\n\n        while (file = this.files[index]) {\n          index++;\n          if (!file.fileObject) ;else if (active && !this.destroy) {\n            if (this.uploading >= this.thread || this.uploading && !this.features.html5) {\n              break;\n            }\n\n            if (!file.active && !file.error && !file.success) {\n              this.update(file, {\n                active: true\n              });\n            }\n          } else {\n            if (file.active) {\n              this.update(file, {\n                active: false\n              });\n            }\n          }\n        }\n\n        if (this.uploading === 0) {\n          this.active = false;\n        }\n      },\n      watchDrop: function watchDrop(newDrop) {\n        var oldDrop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n        if (!this.features.drop) {\n          return;\n        }\n\n        if (newDrop === oldDrop) {\n          return;\n        } // 移除挂载\n\n\n        if (this.dropElement) {\n          try {\n            document.removeEventListener('dragenter', this.onDocumentDragenter, false);\n            document.removeEventListener('dragleave', this.onDocumentDragleave, false);\n            document.removeEventListener('dragover', this.onDocumentDragover, false);\n            document.removeEventListener('drop', this.onDocumentDrop, false);\n            this.dropElement.removeEventListener('dragenter', this.onDragenter, false);\n            this.dropElement.removeEventListener('dragleave', this.onDragleave, false);\n            this.dropElement.removeEventListener('dragover', this.onDragover, false);\n            this.dropElement.removeEventListener('drop', this.onDrop, false);\n          } catch (e) {}\n        }\n\n        var el = null;\n        if (!newDrop) ;else if (typeof newDrop === 'string') {\n          // @ts-ignore\n          el = document.querySelector(newDrop) || this.$root.$el.querySelector(newDrop);\n        } else if (newDrop === true) {\n          var _el;\n\n          // @ts-ignore\n          el = this.$parent.$el;\n\n          if (!el || ((_el = el) === null || _el === void 0 ? void 0 : _el.nodeType) === 8) {\n            var _el2;\n\n            // @ts-ignore\n            el = this.$root.$el;\n\n            if (!el || ((_el2 = el) === null || _el2 === void 0 ? void 0 : _el2.nodeType) === 8) {\n              el = document.body;\n            }\n          }\n        } else {\n          el = newDrop;\n        }\n        this.dropElement = el;\n\n        if (this.dropElement) {\n          document.addEventListener('dragenter', this.onDocumentDragenter, false);\n          document.addEventListener('dragleave', this.onDocumentDragleave, false);\n          document.addEventListener('dragover', this.onDocumentDragover, false);\n          document.addEventListener('drop', this.onDocumentDrop, false);\n          this.dropElement.addEventListener('dragenter', this.onDragenter, false);\n          this.dropElement.addEventListener('dragleave', this.onDragleave, false);\n          this.dropElement.addEventListener('dragover', this.onDragover, false);\n          this.dropElement.addEventListener('drop', this.onDrop, false);\n        }\n      },\n      watchDropActive: function watchDropActive(newDropActive, oldDropActive) {\n        if (newDropActive === oldDropActive) {\n          return;\n        } // 设置 dropElementActive false\n\n\n        if (!newDropActive && this.dropElementActive) {\n          this.dropElementActive = false;\n        }\n\n        if (this.dropTimeout) {\n          clearTimeout(this.dropTimeout);\n          this.dropTimeout = null;\n        }\n\n        if (newDropActive) {\n          // @ts-ignore\n          this.dropTimeout = setTimeout(this.onDocumentDrop, 1000);\n        }\n      },\n      onDocumentDragenter: function onDocumentDragenter(e) {\n        var _dt$files, _dt$types;\n\n        if (this.dropActive) {\n          return;\n        }\n\n        if (!e.dataTransfer) {\n          return;\n        }\n\n        var dt = e.dataTransfer;\n\n        if (dt !== null && dt !== void 0 && (_dt$files = dt.files) !== null && _dt$files !== void 0 && _dt$files.length) {\n          this.dropActive = true;\n        } else if (!dt.types) {\n          this.dropActive = true;\n        } else if (dt.types.indexOf && dt.types.indexOf('Files') !== -1) {\n          this.dropActive = true; // @ts-ignore\n        } else if ((_dt$types = dt.types) !== null && _dt$types !== void 0 && _dt$types.contains && dt.types.contains('Files')) {\n          this.dropActive = true;\n        }\n\n        if (this.dropActive) {\n          this.watchDropActive(true);\n        }\n      },\n      onDocumentDragleave: function onDocumentDragleave(e) {\n        if (!this.dropActive) {\n          return;\n        } // @ts-ignore\n\n\n        if (e.target === e.explicitOriginalTarget || !e.fromElement && (e.clientX <= 0 || e.clientY <= 0 || e.clientX >= window.innerWidth || e.clientY >= window.innerHeight)) {\n          this.dropActive = false;\n          this.watchDropActive(false);\n        }\n      },\n      onDocumentDragover: function onDocumentDragover() {\n        this.watchDropActive(true);\n      },\n      onDocumentDrop: function onDocumentDrop() {\n        this.dropActive = false;\n        this.watchDropActive(false);\n      },\n      onDragenter: function onDragenter(e) {\n        if (!this.dropActive || this.dropElementActive) {\n          return;\n        }\n\n        this.dropElementActive = true;\n      },\n      onDragleave: function onDragleave(e) {\n        var _this$dropElement;\n\n        if (!this.dropElementActive) {\n          return;\n        }\n\n        var related = e.relatedTarget;\n\n        if (!related) {\n          this.dropElementActive = false;\n        } else if ((_this$dropElement = this.dropElement) !== null && _this$dropElement !== void 0 && _this$dropElement.contains) {\n          if (!this.dropElement.contains(related)) {\n            this.dropElementActive = false;\n          }\n        } else {\n          var child = related;\n\n          while (child) {\n            if (child === this.dropElement) {\n              break;\n            } // @ts-ignore\n\n\n            child = child.parentNode;\n          }\n\n          if (child !== this.dropElement) {\n            this.dropElementActive = false;\n          }\n        }\n      },\n      onDragover: function onDragover(e) {\n        e.preventDefault();\n      },\n      onDrop: function onDrop(e) {\n        e.preventDefault();\n        e.dataTransfer && this.addDataTransfer(e.dataTransfer);\n      },\n      inputOnChange: async function inputOnChange(e) {\n        var _this14 = this;\n\n        if (!(e.target instanceof HTMLInputElement)) {\n          return Promise.reject(new Error(\"not HTMLInputElement\"));\n        }\n\n        e.target;\n\n        var reinput = function reinput(res) {\n          _this14.reload = true; // @ts-ignore\n\n          _this14.$nextTick(function () {\n            _this14.reload = false;\n          });\n\n          return res;\n        };\n\n        return this.addInputFile(e.target).then(reinput).catch(reinput);\n      },\n      isRelatedTargetSupported: function isRelatedTargetSupported() {\n        try {\n          // 创建一个模拟的 MouseEvent\n          var event = new MouseEvent('mouseout', {\n            relatedTarget: document.body\n          });\n          return 'relatedTarget' in event; // 检查 `relatedTarget` 属性是否存在\n        } catch (e) {\n          // 如果 MouseEvent 不受支持，或者无法设置 relatedTarget\n          return false;\n        }\n      }\n    }\n  });\n  var _hoisted_1 = [\"for\"];\n  var _hoisted_2 = [\"name\", \"id\", \"accept\", \"capture\", \"disabled\", \"webkitdirectory\", \"allowdirs\", \"directory\", \"multiple\"];\n\n  function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return vue.openBlock(), vue.createElementBlock(\"span\", {\n      class: vue.normalizeClass(_ctx.className)\n    }, [vue.renderSlot(_ctx.$slots, \"default\"), vue.createElementVNode(\"label\", {\n      for: _ctx.forId\n    }, null, 8, _hoisted_1), !_ctx.reload ? (vue.openBlock(), vue.createElementBlock(\"input\", {\n      key: 0,\n      ref: \"input\",\n      type: \"file\",\n      name: _ctx.name,\n      id: _ctx.forId,\n      accept: _ctx.accept,\n      capture: _ctx.capture,\n      disabled: _ctx.disabled,\n      webkitdirectory: _ctx.iDirectory,\n      allowdirs: _ctx.iDirectory,\n      directory: _ctx.iDirectory,\n      multiple: _ctx.multiple && _ctx.features.html5,\n      onChange: _cache[0] || (_cache[0] = function () {\n        return _ctx.inputOnChange && _ctx.inputOnChange.apply(_ctx, arguments);\n      })\n    }, null, 40, _hoisted_2)) : vue.createCommentVNode(\"\", true)], 2);\n  }\n\n  function styleInject(css, ref) {\n    if (ref === void 0) ref = {};\n    var insertAt = ref.insertAt;\n\n    if (!css || typeof document === 'undefined') {\n      return;\n    }\n\n    var head = document.head || document.getElementsByTagName('head')[0];\n    var style = document.createElement('style');\n    style.type = 'text/css';\n\n    if (insertAt === 'top') {\n      if (head.firstChild) {\n        head.insertBefore(style, head.firstChild);\n      } else {\n        head.appendChild(style);\n      }\n    } else {\n      head.appendChild(style);\n    }\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = css;\n    } else {\n      style.appendChild(document.createTextNode(css));\n    }\n  }\n\n  var css_248z = \"\\n.file-uploads {\\n  overflow: hidden;\\n  position: relative;\\n  text-align: center;\\n  display: inline-block;\\n}\\n.file-uploads.file-uploads-html4 input,\\n.file-uploads.file-uploads-html5 label {\\n  /* background fix ie  click */\\n  background: #fff;\\n  opacity: 0;\\n  font-size: 20em;\\n  z-index: 1;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  position: absolute;\\n  width: 100%;\\n  height: 100%;\\n}\\n.file-uploads.file-uploads-html5 input,\\n.file-uploads.file-uploads-html4 label {\\n  /* background fix ie  click */\\n  position: absolute;\\n  background: rgba(255, 255, 255, 0);\\n  overflow: hidden;\\n  position: fixed;\\n  width: 1px;\\n  height: 1px;\\n  z-index: -1;\\n  opacity: 0;\\n}\\n\";\n  styleInject(css_248z);\n  script.render = render;\n\n  return script;\n\n}));\n//# sourceMappingURL=vue-upload-component.js.map\n"],"names":["module","vue","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","_ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_typeof","ownKeys","_objectSpread2","_defineProperty","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","createRequest","options","xhr","XMLHttpRequest","open","method","url","responseType","headers","setRequestHeader","sendRequest","body","Promise","resolve","reject","onload","status","response","JSON","parse","err","onerror","send","stringify","sendFormRequest","data","FormData","append","request","CHUNK_DEFAULT_OPTIONS","action","minSize","maxActive","maxRetries","handler","ChunkUploadHandler","file","this","chunks","sessionId","chunkSize","speedInterval","get","parseInt","type","size","startBody","uploadBody","finishBody","_this","completedProgress","chunksUploaded","uploadingProgress","chunksUploading","reduce","progress","chunk","Math","min","active","uploaded","chunksToUpload","start","end","fileSize","blob","startOffset","retries","stopChunks","abort","stopSpeedCalc","startChunking","_this2","promise","_this3","assign","phase","mime_type","fileType","fileName","then","res","session_id","end_offset","createChunks","catch","maxActiveChunks","uploadNextChunk","startSpeedCalc","hasChunksToUpload","uploadChunk","finish","_this4","updateFileProgress","upload","addEventListener","evt","lengthComputable","round","loaded","total","start_offset","_this5","_this6","speed","lastUploadedBytes","window","setInterval","uploadedBytes","clearInterval","script","defineComponent","compatConfig","MODE","inputId","String","default","accept","capture","disabled","multiple","Boolean","maximum","Number","addIndex","directory","createDirectory","postAction","putAction","customAction","Function","timeout","drop","HTMLElement","dropDirectory","extensions","RegExp","modelValue","thread","chunkEnabled","emits","files","features","html5","dropActive","dropElementActive","uploading","destroy","maps","dropElement","dropTimeout","reload","mounted","_this7","input","document","createElement","webkitdirectory","ondrop","isRelatedTargetSupported","id","$nextTick","$parent","$forceUpdate","watchDrop","beforeUnmount","watchActive","computed","fileObject","error","success","chunkOptions","className","undefined","forId","iMaximum","iExtensions","exts","split","map","trim","join","replace","iDirectory","watch","_active","watchDropActive","oldMaps","newFile","oldFile","emitFile","_key","methods","newId","random","substr","clear","emitInput","add","_files","index","addFiles","Blob","webkitRelativePath","relativePath","Element","el","HTMLInputElement","emitFilter","newFiles","concat","_newFiles","splice","index2","_i","_file","_i2","addInputFile","_this8","entrys","webkitEntries","entries","getFileSystemEntry","names","__vuex__","addDataTransfer","dataTransfer","_dataTransfer$items","_this9","items","dataTransferTtem","entry","getAsEntry","getAsFile","webkitGetAsEntry","maximumValue","_i3","_this10","path","uploadFiles","v","results","isFile","isDirectory","directoryEntry","_uploadFiles","File","dirReader","createReader","readEntries","id1","id2","file1","file2","index1","indexOf","remove","console","update","isPrevent","$emit","_newFile","_this11","setTimeout","_newFile2","e","code","message","ceil","Error","search","shouldUseChunkUpload","uploadPut","uploadHtml5","uploadHtml4","HandlerClass","querys","encodeURIComponent","queryString","uploadXhr","form","filename","ufile","_this12","speedTime","speedLoaded","onprogress","speedTime2","Date","now","toFixed","interval","_file2","complete","fn","responseText","contentType","getResponseHeader","onabort","ontimeout","_this13","onKeydown","keyCode","preventDefault","iframe","src","setAttribute","appendChild","getResponseData","_doc","doc","contentWindow","contentDocument","innerHTML","_file3","removeEventListener","submit","_iframe$parentNode","parentNode","removeChild","_iframe$parentNode2","newDrop","oldDrop","onDocumentDragenter","onDocumentDragleave","onDocumentDragover","onDocumentDrop","onDragenter","onDragleave","onDragover","onDrop","querySelector","$root","$el","_el","_el2","nodeType","newDropActive","oldDropActive","clearTimeout","_dt$files","_dt$types","dt","types","contains","explicitOriginalTarget","fromElement","clientX","clientY","innerWidth","innerHeight","_this$dropElement","related","relatedTarget","child","inputOnChange","async","_this14","reinput","MouseEvent","_hoisted_1","_hoisted_2","render","_ctx","_cache","$props","$setup","$data","$options","openBlock","createElementBlock","class","normalizeClass","renderSlot","$slots","createElementVNode","for","createCommentVNode","ref","allowdirs","onChange","styleInject","css","insertAt","head","getElementsByTagName","style","firstChild","insertBefore","styleSheet","cssText","createTextNode","factory","require$$0"],"mappings":"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"}