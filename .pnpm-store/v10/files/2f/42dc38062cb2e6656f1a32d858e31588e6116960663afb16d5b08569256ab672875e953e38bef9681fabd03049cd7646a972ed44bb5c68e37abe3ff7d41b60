(function(m,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(m=typeof globalThis<"u"?globalThis:m||self,i(m["vue-letter"]={},m.Vue))})(this,function(m,i){"use strict";const N={a:["class","href","id","style","target"],address:["class","id","style"],b:["class","id","style"],blockquote:["class","id","style"],br:["class","id","style"],caption:["class","id","style"],cite:["class","id","style"],code:["class","id","style"],col:["align","bgcolor","char","charoff","class","id","style","valign","width"],colgroup:["align","bgcolor","char","charoff","class","id","style","valign","width"],center:["class","id","style"],dd:["class","id","style"],div:["align","class","dir","id","style"],dt:["class","id","style"],em:["class","id","style"],font:["class","color","face","id","size","style"],h1:["align","class","dir","id","style"],h2:["align","class","dir","id","style"],h3:["align","class","dir","id","style"],h4:["align","class","dir","id","style"],h5:["align","class","dir","id","style"],h6:["align","class","dir","id","style"],hr:["align","size","width"],i:["class","id","style"],img:["align","alt","border","class","height","hspace","id","src","style","title","usemap","vspace","width"],label:["class","id","style"],legend:["class","id","style"],li:["class","dir","id","style","type"],ol:["class","dir","id","style","type","start","reversed"],p:["align","class","dir","id","style"],pre:["class","id","style"],span:["class","id","style"],strong:["class","id","style"],style:[],sub:["class","id","style"],sup:["class","id","style"],table:["align","bgcolor","border","cellpadding","cellspacing","class","dir","frame","id","rules","style","width"],tbody:["class","id","style"],td:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],tfoot:["align","bgcolor","char","charoff","class","id","style","valign"],th:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],thead:["align","bgcolol","char","charoff","class","id","style","valign"],tr:["align","bgcolor","char","charoff","class","dir","id","style","valign"],u:["class","id","style"],ul:["class","dir","id","style"]},q=["script","iframe","textarea","title","noscript","noembed","svg"],B=["azimuth","background","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","box-sizing","break-after","break-before","break-inside","caption-side","clear","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","direction","display","elevation","empty-cells","float","font","font-family","font-feature-settings","font-kerning","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","height","image-orientation","image-resolution","ime-mode","isolation","layout-flow","layout-grid","layout-grid-char","layout-grid-char-spacing","layout-grid-line","layout-grid-mode","layout-grid-type","letter-spacing","line-break","line-height","list-style","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","pitch","pitch-range","quotes","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-align","text-align-last","text-autospace","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-style","text-indent","text-justify","text-kashida-space","text-orientation","text-overflow","text-transform","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","unicode-bidi","vertical-align","voice-family","white-space","white-space-collapse","width","word-break","word-spacing","word-wrap","writing-mode","zoom"];function F(t,o){return o?t.split(",").map(l=>l.trim()).map(l=>{const s=l.replace(/\./g,"."+o+"_").replace(/#/g,"#"+o+"_");return s.toLowerCase().startsWith("body")?"#"+o+" "+s.substring(4):"#"+o+" "+s}).join(","):t}function V(t,o,l){return t.trim().replace(/expression\((.*?)\)/g,"").replace(/url\(["']?(.*?)["']?\)/g,(s,n)=>l?`url("${encodeURI(l(decodeURI(n)))}")`:o.includes(n.toLowerCase().split(":")[0])?s:"")}function _(t,o,l,s,n){if(!t)return;const a=[];for(let c=0;c<t.length;c++){const p=t[c];a.push(p)}for(const c of a)if(l.includes(c)){const p=t.getPropertyValue(c);t.setProperty(c,V(p,o,n),s?t.getPropertyPriority(c):void 0)}else t.removeProperty(c)}function A(t,o,l,s,n,a){t.selectorText=F(t.selectorText,o),_(t.style,l,s,n,a)}const z=["http","https","mailto"];function U(t,{dropAllHtmlTags:o=!1,rewriteExternalLinks:l,rewriteExternalResources:s,id:n="msg_"+String.fromCharCode(...new Array(24).fill(void 0).map(()=>Math.random()*25%25+65)),allowedSchemas:a=z,allowedCssProperties:c=B,preserveCssPriority:p=!0,noWrapper:b=!1}){var H,j,S,I,P;b&&(n="");const d=new DOMParser().parseFromString(t,"text/html");a=Array.isArray(a)?a.map(e=>e.toLowerCase()):z;const v=d.createNodeIterator(d.documentElement,NodeFilter.SHOW_COMMENT);let u;for(;u=v.nextNode();)(H=u.parentNode)==null||H.removeChild(u);const C=[...q];o&&C.push("style"),d.querySelectorAll(C.join(", ")).forEach(e=>e.remove()),d.querySelectorAll("head > style").forEach(e=>{d.body.appendChild(e)});const T=[],E=d.createNodeIterator(d.body,NodeFilter.SHOW_ELEMENT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(;u=E.nextNode();){const e=u,g=e.tagName.toLowerCase();if(!(g==="body"||g==="html")){if(o){if(u.textContent){const h=d.createTextNode(u.textContent);(j=u.parentNode)==null||j.replaceChild(h,u)}else(S=u.parentNode)==null||S.removeChild(u);continue}if(g in N){const h=N[g];for(const r of e.getAttributeNames())if(!h.includes(r))e.removeAttribute(r);else if(r==="class"&&!b)e.setAttribute(r,((I=e.getAttribute(r))==null?void 0:I.split(" ").map(f=>n+"_"+f).join(" "))??"");else if(r==="id"&&!b)e.setAttribute(r,n+"_"+(e.getAttribute(r)??""));else if(r==="href"||r==="src"){const f=e.getAttribute(r)??"";r==="href"&&l?e.setAttribute(r,l(f)):r==="src"&&s?e.setAttribute(r,s(f)):a.includes(f.toLowerCase().split(":")[0])||e.removeAttribute(r)}_(e.style,a,c,p,s),g==="a"&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}else e.insertAdjacentHTML("afterend",e.innerHTML),T.push(e)}}for(const e of T)try{try{(P=e.parentNode)==null||P.removeChild(e)}catch{e.outerHTML=""}}catch{try{e.remove()}catch{}}if(d.querySelectorAll("body style").forEach(e=>{const g=e,h=g.sheet,r=[];if(!h.cssRules){g.textContent="";return}for(let f=0;f<h.cssRules.length;f++){const w=h.cssRules[f];if("selectorText"in w)A(w,n,a,c,p,s),r.push(w);else if("cssRules"in w&&"media"in w){const y=w,O=[];for(let x=0;x<y.cssRules.length;x++){const k=y.cssRules[x];k.type===k.STYLE_RULE&&(A(k,n,a,c,p,s),O.push(k))}for(;y.cssRules.length>0;)y.deleteRule(0);for(const x of O)y.insertRule(x.cssText,y.cssRules.length);r.push(y)}}g.textContent=r.map(f=>f.cssText).join(`
`)}),b)return d.body.innerHTML;{const e=d.createElement("div");return e.id=n,e.innerHTML=d.body.innerHTML,e.outerHTML}}function D(t){const o=document.createElement("div");return o.textContent=t,o.innerHTML}function W(t,o,l){let s=t??"";return(s==null?void 0:s.length)===0&&o&&(s=D(o).split(`
`).map(n=>"<p>"+n+"</p>").join(`
`)),U(s,l??{})}const Y=["innerHTML"],G=["title"],M=i.defineComponent({__name:"Letter",props:{className:{},html:{},text:{},useIframe:{type:Boolean},iframeTitle:{},rewriteExternalLinks:{},rewriteExternalResources:{},allowedCssProperties:{},allowedSchemas:{},preserveCssPriority:{type:Boolean}},setup(t){const o=t,{className:l,html:s,text:n,useIframe:a,iframeTitle:c,rewriteExternalLinks:p,rewriteExternalResources:b,allowedSchemas:d,allowedCssProperties:v,preserveCssPriority:u}=i.reactive(o),L=W(s,n,{rewriteExternalResources:b,rewriteExternalLinks:p,allowedSchemas:d,preserveCssPriority:u,allowedCssProperties:v}),R="data:text/html;charset=utf-8,"+encodeURIComponent(L);return(T,E)=>i.unref(a)?i.unref(a)?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([i.unref(l)])},[i.createElementVNode("iframe",{src:R,title:i.unref(c)},null,8,G)],2)):i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([i.unref(l)]),innerHTML:i.unref(L)},null,10,Y))}}),J={install:t=>{t.component("Letter",M)}};m.Letter=M,m.default=J,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
