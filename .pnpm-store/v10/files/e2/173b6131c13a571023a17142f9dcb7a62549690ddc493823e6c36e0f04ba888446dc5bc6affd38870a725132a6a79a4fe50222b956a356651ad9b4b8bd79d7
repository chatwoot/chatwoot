"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vue"),H={a:["class","href","id","style","target"],address:["class","id","style"],b:["class","id","style"],blockquote:["class","id","style"],br:["class","id","style"],caption:["class","id","style"],cite:["class","id","style"],code:["class","id","style"],col:["align","bgcolor","char","charoff","class","id","style","valign","width"],colgroup:["align","bgcolor","char","charoff","class","id","style","valign","width"],center:["class","id","style"],dd:["class","id","style"],div:["align","class","dir","id","style"],dt:["class","id","style"],em:["class","id","style"],font:["class","color","face","id","size","style"],h1:["align","class","dir","id","style"],h2:["align","class","dir","id","style"],h3:["align","class","dir","id","style"],h4:["align","class","dir","id","style"],h5:["align","class","dir","id","style"],h6:["align","class","dir","id","style"],hr:["align","size","width"],i:["class","id","style"],img:["align","alt","border","class","height","hspace","id","src","style","title","usemap","vspace","width"],label:["class","id","style"],legend:["class","id","style"],li:["class","dir","id","style","type"],ol:["class","dir","id","style","type","start","reversed"],p:["align","class","dir","id","style"],pre:["class","id","style"],span:["class","id","style"],strong:["class","id","style"],style:[],sub:["class","id","style"],sup:["class","id","style"],table:["align","bgcolor","border","cellpadding","cellspacing","class","dir","frame","id","rules","style","width"],tbody:["class","id","style"],td:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],tfoot:["align","bgcolor","char","charoff","class","id","style","valign"],th:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],thead:["align","bgcolol","char","charoff","class","id","style","valign"],tr:["align","bgcolor","char","charoff","class","dir","id","style","valign"],u:["class","id","style"],ul:["class","dir","id","style"]},O=["script","iframe","textarea","title","noscript","noembed","svg"],q=["azimuth","background","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","box-sizing","break-after","break-before","break-inside","caption-side","clear","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","direction","display","elevation","empty-cells","float","font","font-family","font-feature-settings","font-kerning","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","height","image-orientation","image-resolution","ime-mode","isolation","layout-flow","layout-grid","layout-grid-char","layout-grid-char-spacing","layout-grid-line","layout-grid-mode","layout-grid-type","letter-spacing","line-break","line-height","list-style","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","pitch","pitch-range","quotes","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-align","text-align-last","text-autospace","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-style","text-indent","text-justify","text-kashida-space","text-orientation","text-overflow","text-transform","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","unicode-bidi","vertical-align","voice-family","white-space","white-space-collapse","width","word-break","word-spacing","word-wrap","writing-mode","zoom"];function B(t,o){return o?t.split(",").map(i=>i.trim()).map(i=>{const s=i.replace(/\./g,"."+o+"_").replace(/#/g,"#"+o+"_");return s.toLowerCase().startsWith("body")?"#"+o+" "+s.substring(4):"#"+o+" "+s}).join(","):t}function F(t,o,i){return t.trim().replace(/expression\((.*?)\)/g,"").replace(/url\(["']?(.*?)["']?\)/g,(s,l)=>i?`url("${encodeURI(i(decodeURI(l)))}")`:o.includes(l.toLowerCase().split(":")[0])?s:"")}function I(t,o,i,s,l){if(!t)return;const a=[];for(let c=0;c<t.length;c++){const f=t[c];a.push(f)}for(const c of a)if(i.includes(c)){const f=t.getPropertyValue(c);t.setProperty(c,F(f,o,l),s?t.getPropertyPriority(c):void 0)}else t.removeProperty(c)}function S(t,o,i,s,l,a){t.selectorText=B(t.selectorText,o),I(t.style,i,s,l,a)}const j=["http","https","mailto"];function U(t,{dropAllHtmlTags:o=!1,rewriteExternalLinks:i,rewriteExternalResources:s,id:l="msg_"+String.fromCharCode(...new Array(24).fill(void 0).map(()=>Math.random()*25%25+65)),allowedSchemas:a=j,allowedCssProperties:c=q,preserveCssPriority:f=!0,noWrapper:b=!1}){var _,A,z,M,R;b&&(l="");const d=new DOMParser().parseFromString(t,"text/html");a=Array.isArray(a)?a.map(e=>e.toLowerCase()):j;const v=d.createNodeIterator(d.documentElement,NodeFilter.SHOW_COMMENT);let u;for(;u=v.nextNode();)(_=u.parentNode)==null||_.removeChild(u);const k=[...O];o&&k.push("style"),d.querySelectorAll(k.join(", ")).forEach(e=>e.remove()),d.querySelectorAll("head > style").forEach(e=>{d.body.appendChild(e)});const L=[],N=d.createNodeIterator(d.body,NodeFilter.SHOW_ELEMENT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(;u=N.nextNode();){const e=u,g=e.tagName.toLowerCase();if(!(g==="body"||g==="html")){if(o){if(u.textContent){const m=d.createTextNode(u.textContent);(A=u.parentNode)==null||A.replaceChild(m,u)}else(z=u.parentNode)==null||z.removeChild(u);continue}if(g in H){const m=H[g];for(const r of e.getAttributeNames())if(!m.includes(r))e.removeAttribute(r);else if(r==="class"&&!b)e.setAttribute(r,((M=e.getAttribute(r))==null?void 0:M.split(" ").map(p=>l+"_"+p).join(" "))??"");else if(r==="id"&&!b)e.setAttribute(r,l+"_"+(e.getAttribute(r)??""));else if(r==="href"||r==="src"){const p=e.getAttribute(r)??"";r==="href"&&i?e.setAttribute(r,i(p)):r==="src"&&s?e.setAttribute(r,s(p)):a.includes(p.toLowerCase().split(":")[0])||e.removeAttribute(r)}I(e.style,a,c,f,s),g==="a"&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}else e.insertAdjacentHTML("afterend",e.innerHTML),L.push(e)}}for(const e of L)try{try{(R=e.parentNode)==null||R.removeChild(e)}catch{e.outerHTML=""}}catch{try{e.remove()}catch{}}if(d.querySelectorAll("body style").forEach(e=>{const g=e,m=g.sheet,r=[];if(!m.cssRules){g.textContent="";return}for(let p=0;p<m.cssRules.length;p++){const y=m.cssRules[p];if("selectorText"in y)S(y,l,a,c,f,s),r.push(y);else if("cssRules"in y&&"media"in y){const h=y,E=[];for(let w=0;w<h.cssRules.length;w++){const x=h.cssRules[w];x.type===x.STYLE_RULE&&(S(x,l,a,c,f,s),E.push(x))}for(;h.cssRules.length>0;)h.deleteRule(0);for(const w of E)h.insertRule(w.cssText,h.cssRules.length);r.push(h)}}g.textContent=r.map(p=>p.cssText).join(`
`)}),b)return d.body.innerHTML;{const e=d.createElement("div");return e.id=l,e.innerHTML=d.body.innerHTML,e.outerHTML}}function V(t){const o=document.createElement("div");return o.textContent=t,o.innerHTML}function D(t,o,i){let s=t??"";return(s==null?void 0:s.length)===0&&o&&(s=V(o).split(`
`).map(l=>"<p>"+l+"</p>").join(`
`)),U(s,i??{})}const W=["innerHTML"],Y=["title"],P=n.defineComponent({__name:"Letter",props:{className:{},html:{},text:{},useIframe:{type:Boolean},iframeTitle:{},rewriteExternalLinks:{},rewriteExternalResources:{},allowedCssProperties:{},allowedSchemas:{},preserveCssPriority:{type:Boolean}},setup(t){const o=t,{className:i,html:s,text:l,useIframe:a,iframeTitle:c,rewriteExternalLinks:f,rewriteExternalResources:b,allowedSchemas:d,allowedCssProperties:v,preserveCssPriority:u}=n.reactive(o),C=D(s,l,{rewriteExternalResources:b,rewriteExternalLinks:f,allowedSchemas:d,preserveCssPriority:u,allowedCssProperties:v}),T="data:text/html;charset=utf-8,"+encodeURIComponent(C);return(L,N)=>n.unref(a)?n.unref(a)?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([n.unref(i)])},[n.createElementVNode("iframe",{src:T,title:n.unref(c)},null,8,Y)],2)):n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([n.unref(i)]),innerHTML:n.unref(C)},null,10,W))}}),G={install:t=>{t.component("Letter",P)}};exports.Letter=P;exports.default=G;
