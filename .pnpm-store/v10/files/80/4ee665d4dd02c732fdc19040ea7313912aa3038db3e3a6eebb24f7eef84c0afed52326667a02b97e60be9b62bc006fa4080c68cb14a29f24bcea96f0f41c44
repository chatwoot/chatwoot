"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("date-fns/isToday")),r=t(require("date-fns/isYesterday"));function n(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,c,"next",t)}function c(t){n(a,o,i,u,c,"throw",t)}u(void 0)}))}}function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var a,u,c=(function(t){var e=function(t){var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=Object.create((e&&e.prototype instanceof f?e:f).prototype),i=new L(n||[]);return o._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=x(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(t,r,i),o}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function f(){}function h(){}function p(){}var d={};d[o]=function(){return this};var v=Object.getPrototypeOf,m=v&&v(v(T([])));m&&m!==e&&r.call(m,o)&&(d=m);var y=p.prototype=f.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var n;this._invoke=function(o,i){function a(){return new e((function(n,a){!function n(o,i,a,u){var c=s(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,u)}))}u(c.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function x(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=s(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:N}}function N(){return{value:void 0,done:!0}}return h.prototype=y.constructor=p,p.constructor=h,h.displayName=u(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},g(w.prototype),w.prototype[i]=function(){return this},t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(y),u(y,a,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=T,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}(u={exports:{}}),u.exports),s=function(){var t=o(c.mark((function t(e){var r,n,o,i,a,u,s,l,f,h,p,d,v,m;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.type,i=void 0===(o=e.extension)?null:o,(r=e.url)&&n){t.next=3;break}throw new Error("Invalid download parameters");case 3:return t.prev=3,t.next=6,fetch(r,{cache:"no-store"});case 6:if((u=t.sent).ok){t.next=9;break}throw new Error("Download failed: "+u.status);case 9:return t.next=11,u.blob();case 11:s=t.sent,l=u.headers.get("content-type"),f=i||(l?l.split("/")[1]:n),h=u.headers.get("content-disposition"),p=null==h?void 0:h.match(/filename="(.*?)"/),d=null!=(a=null==p?void 0:p[1])?a:"attachment_"+Date.now()+"."+f,v=URL.createObjectURL(s),m=Object.assign(document.createElement("a"),{href:v,download:d,style:"display: none"}),document.body.append(m),m.click(),m.remove(),URL.revokeObjectURL(v),t.next=28;break;case 25:throw t.prev=25,t.t0=t.catch(3),t.t0 instanceof Error?t.t0:new Error("Download failed");case 28:case"end":return t.stop()}}),t,null,[[3,25]])})));return function(e){return t.apply(this,arguments)}}(),l=function(t){return t?t instanceof URL?t:"string"!=typeof t||t.includes("://")||t.startsWith("/")?"string"==typeof t&&t.startsWith("/")?new URL(t,window.location.origin):new URL(t):new URL("https://"+t):null};function f(t){return t.slice().sort((function(t,e){return t-e}))}function h(t,e,r){return r<t?t:r>e?e:r}function p(t,e){var r=h(0,1,e),n=(t.length-1)*r,o=Math.floor(n);return void 0!==t[o+1]?t[o]+(n-o)*(t[o+1]-t[o]):t[o]}!function(t){t[t.INCOMING=0]="INCOMING",t[t.OUTGOING=1]="OUTGOING",t[t.ACTIVITY=2]="ACTIVITY",t[t.TEMPLATE=3]="TEMPLATE"}(a||(a={}));var d=/{{(.*?)}}/g,v=function(t){return t?t.split(" ").map((function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""})).join(" "):""},m=function(t){var e=t.user,r=null!=e&&e.name?e.name.split(" ").shift():"";return v(r)},y=function(t){var e=t.user;if(e&&e.name){var r=e.name.split(" ").length>1?e.name.split(" ").pop():"";return v(r)}return""},g=function(t,e){return null===e?null:t+e-Math.floor(Date.now()/1e3)},w=function(t){var e={y:31536e3,mo:2592e3,d:86400,h:3600,m:60};if(t<60)return"1m";var r=[];return Object.keys(e).forEach((function(n){var o=Math.floor(t/e[n]);t<60&&r.length>0||2!==r.length&&o>0&&(r.push(o+n),t-=o*e[n])})),r.join(" ")};exports.applyRotationTransform=function(t,e,r){var n=r*Math.PI/180,o=Math.cos(-n),i=Math.sin(-n);return{rotatedX:t*o-e*i,rotatedY:t*i+e*o}},exports.calculateCenterOffset=function(t,e,r){return{relativeX:t-(r.left+r.width/2),relativeY:e-(r.top+r.height/2)}},exports.clamp=h,exports.coerceToDate=function(t){if(null==t)return null;var e="number"==typeof t?t:null;if(null===e&&"string"==typeof t&&/^\d+$/.test(t)&&(e=Number(t)),null!==e){var r=10===e.toString().length?1e3*e:e;return new Date(r)}if("string"==typeof t){var n=new Date(t);return Number.isNaN(n.getTime())?null:(/T\d{2}:\d{2}(:\d{2})?/.test(t)||/\d{2}:\d{2}/.test(t)||n.setHours(0,0,0,0),n)}return null},exports.convertSecondsToTimeUnit=function(t,e){return null===t||0===t?{time:"",unit:""}:t<3600?{time:Number((t/60).toFixed(1)),unit:e.minute}:t<86400?{time:Number((t/3600).toFixed(1)),unit:e.hour}:{time:Number((t/86400).toFixed(1)),unit:e.day}},exports.createTypingIndicator=function(t,e,r){var n=null,o=function(){n&&(clearTimeout(n),n=null,e())};return{start:function(){n||t(),n&&clearTimeout(n),n=setTimeout((function(){o()}),r)},stop:o}},exports.debounce=function(t,e,r,n){var o=null,i=0;return function(){for(var a=this,u=arguments.length,c=new Array(u),s=0;s<u;s++)c[s]=arguments[s];var l=Date.now(),f=0===i;if(f&&r)return i=l,void t.apply(this,c);null!==o&&(clearTimeout(o),o=null);var h=l-i,p=void 0!==n&&h>=n;if(p)return i=l,void t.apply(this,c);o=setTimeout((function(){i=Date.now(),o=null,t.apply(a,c)}),e)}},exports.downloadFile=s,exports.evaluateSLAStatus=function(t){var e=t.appliedSla,r=t.chat;if(!e||!r)return{type:"",threshold:"",icon:"",isSlaMissed:!1};var n,o=((n=function(t,e){return["FRT","NRT","RT"].map((function(r){return function(t,e,r){var n=e.sla_first_response_time_threshold,o=e.sla_next_response_time_threshold,a=e.sla_resolution_time_threshold,u=e.created_at,c=r.first_reply_created_at,s=r.waiting_since,l=r.status,f={FRT:{threshold:g(u,n),condition:null!==n&&(!c||0===c)},NRT:{threshold:g(s,o),condition:null!==o&&!!c&&!!s},RT:{threshold:g(u,a),condition:"open"===l&&null!==a}}[t];return f?i({},f,{type:t}):null}(r,t,e)})).filter((function(t){return!!t&&t.condition})).map((function(t){return i({},t,{icon:t.threshold<=0?"flame":"alarm",isSlaMissed:t.threshold<=0})}))}(e,r)).sort((function(t,e){return Math.abs(t.threshold)-Math.abs(e.threshold)})),n[0]);return o?{type:null==o?void 0:o.type,threshold:w(o.threshold<=0?-o.threshold:o.threshold),icon:o.icon,isSlaMissed:o.isSlaMissed}:{type:"",threshold:"",icon:"",isSlaMissed:!1}},exports.fileNameWithEllipsis=function(t,e,r){var n,o;void 0===e&&(e=26),void 0===r&&(r="…");var i=null!=(n=null!=(o=null==t?void 0:t.filename)?o:null==t?void 0:t.name)?n:"Untitled",a=i.lastIndexOf(".");if(-1===a)return i;var u=[i.slice(0,a),i.slice(a)],c=u[0],s=u[1];return c.length<=e?i:""+c.slice(0,e)+r+s},exports.formatDate=function(t){var n=t.date,o=t.todayText,i=t.yesterdayText,a=new Date(n);return e(a)?o:r(a)?i:n},exports.formatNumber=function(t){var e=Number(t)||0;return new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(e)},exports.formatTime=function(t){var e="";if(t>=60&&t<3600){var r=Math.floor(t/60);e=r+" Min";var n=60===r?0:Math.floor(t%60);return e+(n>0?" "+n+" Sec":"")}if(t>=3600&&t<86400){var o=Math.floor(t/3600);e=o+" Hr";var i=t%3600<60||24===o?0:Math.floor(t%3600/60);return e+(i>0?" "+i+" Min":"")}if(t>=86400){var a=Math.floor(t/86400);e=a+" Day";var u=t%86400<3600||a>=364?0:Math.floor(t%86400/3600);return e+(u>0?" "+u+" Hr":"")}return Math.floor(t)+" Sec"},exports.getContrastingTextColor=function(t){var e=t.replace("#","");return.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>186?"#000000":"#FFFFFF"},exports.getFileInfo=function(t){var e={name:"Unknown File",type:"",base:"Unknown File"};if(!t||"string"!=typeof t)return e;try{var r=t.split(/[?#]/)[0].replace(/\\/g,"/").split("/").pop();if(!r)return e;var n=decodeURIComponent(r);if(n.startsWith(".")&&!n.includes(".",1))return{name:n,type:"",base:n};var o=n.lastIndexOf(".");if(-1===o||0===o)return{name:n,type:"",base:n};var i=n.slice(0,o),a=n.slice(o+1).toLowerCase();return{name:n,type:a,base:i}}catch(t){return console.error("Error processing file info:",t),e}},exports.getMessageVariables=function(t){var e,r=t.conversation,n=r.meta,o=n.assignee,a=n.sender,u=r.id,c=r.custom_attributes,s=void 0===c?{}:c,l=(t.contact||{}).custom_attributes;return i({},{"contact.name":v((null==a?void 0:a.name)||""),"contact.first_name":m({user:a}),"contact.last_name":y({user:a}),"contact.email":null==a?void 0:a.email,"contact.phone":null==a?void 0:a.phone_number,"contact.id":null==a?void 0:a.id,"conversation.id":u,"agent.name":v((null==o?void 0:o.name)||""),"agent.first_name":m({user:o}),"agent.last_name":y({user:o}),"agent.email":null!=(e=null==o?void 0:o.email)?e:""},Object.entries(null!=s?s:{}).reduce((function(t,e){return t["conversation.custom_attribute."+e[0]]=e[1],t}),{}),Object.entries(null!=l?l:{}).reduce((function(t,e){return t["contact.custom_attribute."+e[0]]=e[1],t}),{}))},exports.getQuantileIntervals=function(t,e){var r=f(t);return e.map((function(t){return p(r,t)}))},exports.getRecipients=function(t,e,r,n){var o,i=[],u=[],c=[];if(!t)return{to:i,cc:u,bcc:c};var s,l,f,h,p,d,v=t.message_type===a.INCOMING,m={};if(v){var y=t.content_attributes.email;m={cc:(null==y?void 0:y.cc)||[],bcc:(null==y?void 0:y.bcc)||[],from:(null==y?void 0:y.from)||[],to:[]}}else{var g=t.content_attributes,w=null!=g?g:{},x=w.cc_emails,b=w.bcc_emails,_=w.to_emails;m={cc:void 0===x?[]:x,bcc:void 0===b?[]:b,to:void 0===_?[]:_,from:[]}}s=v&&(null!=(o=m.from)?o:[]).includes(e),v?(l=i).push.apply(l,null!=(f=m.from)?f:[]):(h=i).push.apply(h,null!=(p=m.to)?p:[e]),u=m.cc?[].concat(m.cc):[],Array.isArray(m.to)&&v&&(d=u).push.apply(d,m.to),!s&&v&&u.push(e),c=(m.bcc||[]).filter((function(t){return t!==e}));var L=/^reply\+([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i;return u=u.filter((function(t){return!(t===e&&s||t===r||t===n||L.test(t))})),c=c.filter((function(t){return t!==r&&t!==n&&!L.test(t)})),{to:i=Array.from(new Set(i)),cc:u=Array.from(new Set(u)),bcc:c=Array.from(new Set(c))}},exports.getUndefinedVariablesInMessage=function(t){var e=t.variables,r=t.message.replace(/```(?:.|\n)+?```/g,"").match(d);return r?r.map((function(t){return t.replace("{{","").replace("}}","").trim()})).filter((function(t){return void 0===e[t]})):[]},exports.isSameHost=function(t,e){try{var r=l(t),n=l(e);return!(!r||!n)&&r.hostname===n.hostname}catch(t){return!1}},exports.normalizeToPercentage=function(t,e,r,n){return{x:Math.max(0,Math.min(100,50+t/(r/2)*50)),y:Math.max(0,Math.min(100,50+e/(n/2)*50))}},exports.parseBoolean=function(t){try{var e=String(t).toLowerCase();return Boolean(JSON.parse(e))}catch(t){return!1}},exports.quantile=function(t,e){return p(f(t),e)},exports.replaceVariablesInMessage=function(t){var e=t.message,r=t.variables;return null==e?void 0:e.replace(d,(function(t,e){return r[e.trim()]?r[e.trim().toLowerCase()]:""}))},exports.sortAsc=f,exports.splitName=function(t){var e=t.trim();if(!e)return{firstName:"",lastName:""};var r=e.split(/\s+/);if(1===r.length)return{firstName:r[0],lastName:""};var n=r.pop()||"";return{firstName:r.join(" "),lastName:n}},exports.toURL=l,exports.trimContent=function(t,e,r){void 0===t&&(t=""),void 0===e&&(e=1024),void 0===r&&(r=!1);var n=t;return t.length>e&&(n=t.substring(0,e)),r&&(n+="..."),n};
//# sourceMappingURL=utils.cjs.production.min.js.map
