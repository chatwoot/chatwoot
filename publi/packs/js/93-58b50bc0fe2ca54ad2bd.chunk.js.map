{"version":3,"sources":["webpack:///./app/javascript/dashboard/mixins/reportMixin.js","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue?d6d7","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue?bcaa","webpack:///app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue?58aa","webpack:///app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue?6b6f","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/Index.vue?1ee5","webpack:///app/javascript/dashboard/routes/dashboard/settings/reports/Index.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/Index.vue?cefc","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/Index.vue"],"names":["computed","mapGetters","accountSummary","accountReport","methods","calculateTrend","key","this","previous","diff","Math","round","displayMetric","isAverageMetricType","formatTime","Number","toLocaleString","displayInfoText","metrics","currentSelection","KEY","total","data","map","item","count","reduce","prev","curr","INFO_TEXT","includes","_vm","_c","_self","staticClass","_v","_s","metric","NAME","trend","class","trendColor","_e","_l","attrs","isFetching","$t","getCollection","getChartOptions","component","on","downloadAgentReports","onFilterChange","groupBy"],"mappings":"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","file":"js/93-58b50bc0fe2ca54ad2bd.chunk.js","sourcesContent":["import { mapGetters } from 'vuex';\nimport { formatTime } from '@chatwoot/utils';\n\nexport default {\n  computed: {\n    ...mapGetters({\n      accountSummary: 'getAccountSummary',\n      accountReport: 'getAccountReports',\n    }),\n  },\n  methods: {\n    calculateTrend(key) {\n      if (!this.accountSummary.previous[key]) return 0;\n      const diff = this.accountSummary[key] - this.accountSummary.previous[key];\n      return Math.round((diff / this.accountSummary.previous[key]) * 100);\n    },\n    displayMetric(key) {\n      if (this.isAverageMetricType(key)) {\n        return formatTime(this.accountSummary[key]);\n      }\n      return Number(this.accountSummary[key] || '').toLocaleString();\n    },\n    displayInfoText(key) {\n      if (this.metrics[this.currentSelection].KEY !== key) {\n        return '';\n      }\n      if (this.isAverageMetricType(key)) {\n        const total = this.accountReport.data\n          .map(item => item.count)\n          .reduce((prev, curr) => prev + curr, 0);\n        return `${this.metrics[this.currentSelection].INFO_TEXT} ${total}`;\n      }\n      return '';\n    },\n    isAverageMetricType(key) {\n      return [\n        'avg_first_response_time',\n        'avg_resolution_time',\n        'reply_time',\n      ].includes(key);\n    },\n  },\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 bg-white dark:bg-slate-800 p-2 border border-slate-100 dark:border-slate-700 rounded-md\"},_vm._l((_vm.metrics),function(metric){return _c('div',{key:metric.KEY,staticClass:\"p-4 rounded-md mb-3\"},[_c('chart-stats',{attrs:{\"metric\":metric}}),_vm._v(\" \"),_c('div',{staticClass:\"mt-4 h-72\"},[(_vm.accountReport.isFetching[metric.KEY])?_c('woot-loading-state',{staticClass:\"text-xs\",attrs:{\"message\":_vm.$t('REPORT.LOADING_CHART')}}):_c('div',{staticClass:\"h-72 flex items-center justify-center\"},[(_vm.accountReport.data[metric.KEY].length)?_c('woot-bar',{staticClass:\"h-72 w-full\",attrs:{\"collection\":_vm.getCollection(metric),\"chart-options\":_vm.getChartOptions(metric)}}):_c('span',{staticClass:\"text-sm text-slate-600\"},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('REPORT.NO_ENOUGH_DATA'))+\"\\n        \")])],1)],1)],1)}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartStats.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartStats.vue?vue&type=script&lang=js&\"","<template>\n  <div>\n    <span class=\"text-sm\">{{ metric.NAME }}</span>\n    <div class=\"flex items-end\">\n      <div class=\"font-medium text-xl\">\n        {{ displayMetric(metric.KEY) }}\n      </div>\n      <div v-if=\"metric.trend\" class=\"text-xs ml-4 flex items-center mb-0.5\">\n        <div\n          v-if=\"metric.trend < 0\"\n          class=\"h-0 w-0 border-x-4 medium border-x-transparent border-t-[8px] mr-1\"\n          :class=\"trendColor(metric.trend, metric.KEY)\"\n        />\n        <div\n          v-else\n          class=\"h-0 w-0 border-x-4 medium border-x-transparent border-b-[8px] mr-1\"\n          :class=\"trendColor(metric.trend, metric.KEY)\"\n        />\n        <span class=\"font-medium\" :class=\"trendColor(metric.trend, metric.KEY)\">\n          {{ calculateTrend(metric.KEY) }}%\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport reportMixin from 'dashboard/mixins/reportMixin';\nexport default {\n  mixins: [reportMixin],\n  props: {\n    metric: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  methods: {\n    trendColor(value, key) {\n      if (this.isAverageMetricType(key)) {\n        return value > 0\n          ? 'border-red-500 text-red-500'\n          : 'border-green-500 text-green-500';\n      }\n      return value < 0\n        ? 'border-red-500 text-red-500'\n        : 'border-green-500 text-green-500';\n    },\n  },\n};\n</script>\n","import { render, staticRenderFns } from \"./ChartStats.vue?vue&type=template&id=61ed5976&\"\nimport script from \"./ChartStats.vue?vue&type=script&lang=js&\"\nexport * from \"./ChartStats.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('span',{staticClass:\"text-sm\"},[_vm._v(_vm._s(_vm.metric.NAME))]),_vm._v(\" \"),_c('div',{staticClass:\"flex items-end\"},[_c('div',{staticClass:\"font-medium text-xl\"},[_vm._v(\"\\n      \"+_vm._s(_vm.displayMetric(_vm.metric.KEY))+\"\\n    \")]),_vm._v(\" \"),(_vm.metric.trend)?_c('div',{staticClass:\"text-xs ml-4 flex items-center mb-0.5\"},[(_vm.metric.trend < 0)?_c('div',{staticClass:\"h-0 w-0 border-x-4 medium border-x-transparent border-t-[8px] mr-1\",class:_vm.trendColor(_vm.metric.trend, _vm.metric.KEY)}):_c('div',{staticClass:\"h-0 w-0 border-x-4 medium border-x-transparent border-b-[8px] mr-1\",class:_vm.trendColor(_vm.metric.trend, _vm.metric.KEY)}),_vm._v(\" \"),_c('span',{staticClass:\"font-medium\",class:_vm.trendColor(_vm.metric.trend, _vm.metric.KEY)},[_vm._v(\"\\n        \"+_vm._s(_vm.calculateTrend(_vm.metric.KEY))+\"%\\n      \")])]):_vm._e()])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div\n    class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 bg-white dark:bg-slate-800 p-2 border border-slate-100 dark:border-slate-700 rounded-md\"\n  >\n    <div\n      v-for=\"metric in metrics\"\n      :key=\"metric.KEY\"\n      class=\"p-4 rounded-md mb-3\"\n    >\n      <chart-stats :metric=\"metric\" />\n      <div class=\"mt-4 h-72\">\n        <woot-loading-state\n          v-if=\"accountReport.isFetching[metric.KEY]\"\n          class=\"text-xs\"\n          :message=\"$t('REPORT.LOADING_CHART')\"\n        />\n        <div v-else class=\"h-72 flex items-center justify-center\">\n          <woot-bar\n            v-if=\"accountReport.data[metric.KEY].length\"\n            :collection=\"getCollection(metric)\"\n            :chart-options=\"getChartOptions(metric)\"\n            class=\"h-72 w-full\"\n          />\n          <span v-else class=\"text-sm text-slate-600\">\n            {{ $t('REPORT.NO_ENOUGH_DATA') }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { GROUP_BY_FILTER, METRIC_CHART } from './constants';\nimport fromUnixTime from 'date-fns/fromUnixTime';\nimport format from 'date-fns/format';\nimport { formatTime } from '@chatwoot/utils';\nimport reportMixin from 'dashboard/mixins/reportMixin';\nimport ChartStats from './components/ChartElements/ChartStats.vue';\nconst REPORTS_KEYS = {\n  CONVERSATIONS: 'conversations_count',\n  INCOMING_MESSAGES: 'incoming_messages_count',\n  OUTGOING_MESSAGES: 'outgoing_messages_count',\n  FIRST_RESPONSE_TIME: 'avg_first_response_time',\n  RESOLUTION_TIME: 'avg_resolution_time',\n  RESOLUTION_COUNT: 'resolutions_count',\n  REPLY_TIME: 'reply_time',\n};\n\nexport default {\n  components: { ChartStats },\n  mixins: [reportMixin],\n  props: {\n    groupBy: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  computed: {\n    metrics() {\n      const reportKeys = [\n        'CONVERSATIONS',\n        'FIRST_RESPONSE_TIME',\n        'REPLY_TIME',\n        'RESOLUTION_TIME',\n        'RESOLUTION_COUNT',\n        'INCOMING_MESSAGES',\n        'OUTGOING_MESSAGES',\n      ];\n      const infoText = {\n        FIRST_RESPONSE_TIME: this.$t(\n          `REPORT.METRICS.FIRST_RESPONSE_TIME.INFO_TEXT`\n        ),\n        RESOLUTION_TIME: this.$t(`REPORT.METRICS.RESOLUTION_TIME.INFO_TEXT`),\n      };\n      return reportKeys.map(key => ({\n        NAME: this.$t(`REPORT.METRICS.${key}.NAME`),\n        KEY: REPORTS_KEYS[key],\n        DESC: this.$t(`REPORT.METRICS.${key}.DESC`),\n        INFO_TEXT: infoText[key],\n        TOOLTIP_TEXT: `REPORT.METRICS.${key}.TOOLTIP_TEXT`,\n        trend: this.calculateTrend(REPORTS_KEYS[key]),\n      }));\n    },\n  },\n  methods: {\n    getCollection(metric) {\n      if (!this.accountReport.data[metric.KEY]) {\n        return {};\n      }\n      const data = this.accountReport.data[metric.KEY];\n      const labels = data.map(element => {\n        if (this.groupBy?.period === GROUP_BY_FILTER[2].period) {\n          let week_date = new Date(fromUnixTime(element.timestamp));\n          const first_day = week_date.getDate() - week_date.getDay();\n          const last_day = first_day + 6;\n          const week_first_date = new Date(week_date.setDate(first_day));\n          const week_last_date = new Date(week_date.setDate(last_day));\n          return `${format(week_first_date, 'dd-MMM')} - ${format(\n            week_last_date,\n            'dd-MMM'\n          )}`;\n        }\n        if (this.groupBy?.period === GROUP_BY_FILTER[3].period) {\n          return format(fromUnixTime(element.timestamp), 'MMM-yyyy');\n        }\n        if (this.groupBy?.period === GROUP_BY_FILTER[4].period) {\n          return format(fromUnixTime(element.timestamp), 'yyyy');\n        }\n        return format(fromUnixTime(element.timestamp), 'dd-MMM');\n      });\n      const datasets = METRIC_CHART[metric.KEY].datasets.map(dataset => {\n        switch (dataset.type) {\n          case 'bar':\n            return {\n              ...dataset,\n              yAxisID: 'y-left',\n              label: metric.NAME,\n              data: data.map(element => element.value),\n            };\n          case 'line':\n            return {\n              ...dataset,\n              yAxisID: 'y-right',\n              label: this.metrics[0].NAME,\n              data: data.map(element => element.count),\n            };\n          default:\n            return dataset;\n        }\n      });\n      return {\n        labels,\n        datasets,\n      };\n    },\n    getChartOptions(metric) {\n      let tooltips = {};\n      if (this.isAverageMetricType(metric.KEY)) {\n        tooltips.callbacks = {\n          label: tooltipItem => {\n            return this.$t(metric.TOOLTIP_TEXT, {\n              metricValue: formatTime(tooltipItem.yLabel),\n              conversationCount:\n                this.accountReport.data[metric.KEY][tooltipItem.index].count,\n            });\n          },\n        };\n      }\n      return {\n        scales: METRIC_CHART[metric.KEY].scales,\n        tooltips: tooltips,\n      };\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportContainer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportContainer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ReportContainer.vue?vue&type=template&id=cf6cf834&\"\nimport script from \"./ReportContainer.vue?vue&type=script&lang=js&\"\nexport * from \"./ReportContainer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"flex-1 overflow-auto p-4\"},[_c('woot-button',{attrs:{\"color-scheme\":\"success\",\"class-names\":\"button--fixed-top\",\"icon\":\"arrow-download\"},on:{\"click\":_vm.downloadAgentReports}},[_vm._v(\"\\n    \"+_vm._s(_vm.$t('REPORT.DOWNLOAD_AGENT_REPORTS'))+\"\\n  \")]),_vm._v(\" \"),_c('report-filter-selector',{attrs:{\"show-agents-filter\":false,\"show-group-by-filter\":true},on:{\"filter-change\":_vm.onFilterChange}}),_vm._v(\" \"),_c('report-container',{attrs:{\"group-by\":_vm.groupBy}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"flex-1 overflow-auto p-4\">\n    <woot-button\n      color-scheme=\"success\"\n      class-names=\"button--fixed-top\"\n      icon=\"arrow-download\"\n      @click=\"downloadAgentReports\"\n    >\n      {{ $t('REPORT.DOWNLOAD_AGENT_REPORTS') }}\n    </woot-button>\n    <report-filter-selector\n      :show-agents-filter=\"false\"\n      :show-group-by-filter=\"true\"\n      @filter-change=\"onFilterChange\"\n    />\n    <report-container :group-by=\"groupBy\" />\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport fromUnixTime from 'date-fns/fromUnixTime';\nimport format from 'date-fns/format';\nimport ReportFilterSelector from './components/FilterSelector.vue';\nimport { GROUP_BY_FILTER } from './constants';\nimport reportMixin from 'dashboard/mixins/reportMixin';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { REPORTS_EVENTS } from '../../../../helper/AnalyticsHelper/events';\nimport ReportContainer from './ReportContainer.vue';\n\nconst REPORTS_KEYS = {\n  CONVERSATIONS: 'conversations_count',\n  INCOMING_MESSAGES: 'incoming_messages_count',\n  OUTGOING_MESSAGES: 'outgoing_messages_count',\n  FIRST_RESPONSE_TIME: 'avg_first_response_time',\n  RESOLUTION_TIME: 'avg_resolution_time',\n  RESOLUTION_COUNT: 'resolutions_count',\n  REPLY_TIME: 'reply_time',\n};\n\nexport default {\n  name: 'ConversationReports',\n  components: {\n    ReportFilterSelector,\n    ReportContainer,\n  },\n  mixins: [reportMixin, alertMixin],\n  data() {\n    return {\n      from: 0,\n      to: 0,\n      groupBy: GROUP_BY_FILTER[1],\n      businessHours: false,\n    };\n  },\n  computed: {\n    ...mapGetters({\n      accountSummary: 'getAccountSummary',\n      accountReport: 'getAccountReports',\n    }),\n  },\n  methods: {\n    fetchAllData() {\n      this.fetchAccountSummary();\n      this.fetchChartData();\n    },\n    fetchAccountSummary() {\n      try {\n        this.$store.dispatch('fetchAccountSummary', this.getRequestPayload());\n      } catch {\n        this.showAlert(this.$t('REPORT.SUMMARY_FETCHING_FAILED'));\n      }\n    },\n    fetchChartData() {\n      [\n        'CONVERSATIONS',\n        'INCOMING_MESSAGES',\n        'OUTGOING_MESSAGES',\n        'FIRST_RESPONSE_TIME',\n        'RESOLUTION_TIME',\n        'RESOLUTION_COUNT',\n        'REPLY_TIME',\n      ].forEach(async key => {\n        try {\n          await this.$store.dispatch('fetchAccountReport', {\n            metric: REPORTS_KEYS[key],\n            ...this.getRequestPayload(),\n          });\n        } catch {\n          this.showAlert(this.$t('REPORT.DATA_FETCHING_FAILED'));\n        }\n      });\n    },\n    getRequestPayload() {\n      const { from, to, groupBy, businessHours } = this;\n\n      return {\n        from,\n        to,\n        groupBy: groupBy?.period,\n        businessHours,\n      };\n    },\n    downloadAgentReports() {\n      const { from, to } = this;\n      const fileName = `agent-report-${format(\n        fromUnixTime(to),\n        'dd-MM-yyyy'\n      )}.csv`;\n      this.$store.dispatch('downloadAgentReports', { from, to, fileName });\n    },\n    onFilterChange({ from, to, groupBy, businessHours }) {\n      this.from = from;\n      this.to = to;\n      this.groupBy = groupBy;\n      this.businessHours = businessHours;\n      this.fetchAllData();\n\n      this.$track(REPORTS_EVENTS.FILTER_REPORT, {\n        filterValue: { from, to, groupBy, businessHours },\n        reportType: 'conversations',\n      });\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=6ad043ff&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}